Testing reaction products enumberator with different options

*** Test set ***
('rpe-multistep-reactions', '0')
('rpe-mode', 'grid')
('rpe-self-reaction', '0')
('rpe-max-depth', '1')
('rpe-max-products-count', '4')
Test 1
  CC=CC(=O)NC1CCCC1
  CC=CC(=O)NCC
  CC=CC(=O)N[C@@H](C)CC
  CCNC(=O)C=CC(O)=O
Test 1_aam
  C/C=C/C(=O)NC1CCCC1
  C/C=C/C(=O)NCC
  C/C=C/C(=O)N[C@@H](C)CC
  CCNC(=O)/C=C\C(O)=O
Test 2
  O=C1C=CC(=O)[C@@H]2CC=CC[C@H]12 |&1:6,11|
  O=C1CC[C@@H]2CC=CC[C@H]12 |&1:4,9|
  O=C1OC(=O)[C@@H]2CC=CC[C@H]12 |&1:5,10|
  O=C1[C@@H]2CC=CC[C@@H]2C(=O)C2C=CC=CC1=2 |&1:2,7|
Test 3
  CC(=O)O[C@@H]1[C@@H](O)[C@H](O)[C@@H](O)[C@H](O)[C@H]1O
  O[C@H]1[C@H](O)[C@@H](O)[C@H](OC(=O)C2CCCCC2)[C@@H](O)[C@@H]1O
Test 4
  NCC1OC1C(=O)NCC1OC1C(O)=O
Test 5
  CC(=O)O[C@@H]1O[C@H](CO)[C@@H](O)[C@H](O)[C@H]1O
  CC(=O)O[C@@H]1[C@@H](CO)O[C@@H](O)[C@H](O)[C@H]1O
  CC(=O)O[C@@H]1[C@@H](O)[C@H](O)O[C@H](CO)[C@H]1O
  CC(=O)O[C@@H]1[C@@H](O)[C@H](O)[C@@H](CO)O[C@H]1O
Test 6
  C[C@@H](Cl)N(C)S
  C[C@@H](Cl)[N@@](C)S |&1:1,&2:3|
  C[C@@H](Cl)[N@@](C)S |&1:1,o1:3|
  C[C@H](Cl)N(C)S
Test 7
  C[N@@](S)/C=C/[C@H](O)Cl
  N/C=C/O
  N/C=C\O
Test 8
  NCC(=O)NCCCC[C@@H](N)C(O)=O |&1:9|
  NCCCC[C@@H](N)C(=O)NCC(O)=O |&1:5|
  NCCCC[C@@H](NC(=O)CN)C(O)=O |&1:5|
Test 9
  N[C@H]1CCC[C@H]1C(=O)N(C(C1C=CC(=CC=1)[N+]([O-])=O)C(=O)NC1CCCCC1)[C@H]1CCC[C@H]1C(O)=O

*** Test set ***
('rpe-multistep-reactions', '0')
('rpe-mode', 'grid')
('rpe-self-reaction', '0')
('rpe-max-depth', '1')
('rpe-max-products-count', '10')
Test 1
  CC=CC(=O)NC1CCCC1
  CC=CC(=O)NCC
  CC=CC(=O)N[C@@H](C)CC
  CCNC(=O)C=CC(O)=O
  C[C@@H](C(=O)NCC)C1C=CC=CC=1 |&1:1|
  C[C@@H](C(=O)N[C@@H](C)CC)C1C=CC=CC=1 |&1:1,a:5|
  C[C@@H](C1=CC=CC=C1)C(=O)NC1CCCC1 |&1:1|
  C[C@@H](CC)NC(=O)C=CC(O)=O
  OC(=O)C=CC(=O)NC1CCCC1
Test 1_aam
  C/C=C/C(=O)NC1CCCC1
  C/C=C/C(=O)NCC
  C/C=C/C(=O)N[C@@H](C)CC
  CCNC(=O)/C=C\C(O)=O
  C[C@@H](C(=O)NCC)C1C=CC=CC=1 |&1:1|
  C[C@@H](C(=O)N[C@@H](C)CC)C1C=CC=CC=1 |&1:1,a:5|
  C[C@@H](C1=CC=CC=C1)C(=O)NC1CCCC1 |&1:1|
  C[C@@H](CC)NC(=O)/C=C\C(O)=O
  OC(=O)/C=C\C(=O)NC1CCCC1
Test 2
  CC1C=CC[C@@H]2[C@H]1C(=O)C1C=CC=CC=1C2=O |&1:5,6|
  CC1C=CC[C@@H]2[C@H]1C(=O)C=CC2=O |&1:5,6|
  CC1C=CC[C@@H]2[C@H]1C(=O)OC2=O |&1:5,6|
  CC1C=CC[C@@H]2[C@H]1CCC2=O |&1:5,6|
  C[C@@H]1CC=CC[C@]1(C)C=O |&1:1,6|
  C[C@@]1(CC=CC[C@]1(C)F)C=O |&1:1,6|
  O=C1C=CC(=O)[C@@H]2CC=CC[C@H]12 |&1:6,11|
  O=C1CC[C@@H]2CC=CC[C@H]12 |&1:4,9|
  O=C1OC(=O)[C@@H]2CC=CC[C@H]12 |&1:5,10|
  O=C1[C@@H]2CC=CC[C@@H]2C(=O)C2C=CC=CC1=2 |&1:2,7|
Test 3
  CC(=O)O[C@@H]1[C@@H](O)[C@H](O)[C@@H](O)[C@H](O)[C@H]1O
  O[C@H]1[C@H](O)[C@@H](O)[C@H](OC(=O)C2CCCCC2)[C@@H](O)[C@@H]1O
Test 4
  NCC1OC1C(=O)NCC1OC1C(O)=O
Test 5
  CC(=O)OC[C@H]1O[C@@H](O)[C@H](O)[C@@H](O)[C@@H]1O
  CC(=O)O[C@@H]1O[C@H](CO)[C@@H](O)[C@H](O)[C@H]1O
  CC(=O)O[C@@H]1[C@@H](CO)O[C@@H](O)[C@H](O)[C@H]1O
  CC(=O)O[C@@H]1[C@@H](O)[C@H](O)O[C@H](CO)[C@H]1O
  CC(=O)O[C@@H]1[C@@H](O)[C@H](O)[C@@H](CO)O[C@H]1O
Test 6
  C[C@@H](Cl)N(C)S
  C[C@@H](Cl)[N@@](C)S |&1:1,&2:3|
  C[C@@H](Cl)[N@@](C)S |&1:1,o1:3|
  C[C@H](Cl)N(C)S
Test 7
  C[N@@](S)/C=C/[C@H](O)Cl
  N/C=C/O
  N/C=C\O
Test 8
  NCC(=O)NCCCC[C@@H](N)C(O)=O |&1:9|
  NCCCC[C@@H](N)C(=O)NCC(O)=O |&1:5|
  NCCCC[C@@H](NC(=O)CN)C(O)=O |&1:5|
Test 9
  N[C@H]1CCC[C@H]1C(=O)N(C(C1C=CC(=CC=1)[N+]([O-])=O)C(=O)NC1CCCCC1)[C@H]1CCC[C@H]1C(O)=O

*** Test set ***
('rpe-multistep-reactions', '0')
('rpe-mode', 'grid')
('rpe-self-reaction', '0')
('rpe-max-depth', '3')
('rpe-max-products-count', '4')
Test 1
  CC=CC(=O)NC1CCCC1
  CC=CC(=O)NCC
  CC=CC(=O)N[C@@H](C)CC
  CCNC(=O)C=CC(O)=O
Test 1_aam
  C/C=C/C(=O)NC1CCCC1
  C/C=C/C(=O)NCC
  C/C=C/C(=O)N[C@@H](C)CC
  CCNC(=O)/C=C\C(O)=O
Test 2
  O=C1C=CC(=O)[C@@H]2CC=CC[C@H]12 |&1:6,11|
  O=C1CC[C@@H]2CC=CC[C@H]12 |&1:4,9|
  O=C1OC(=O)[C@@H]2CC=CC[C@H]12 |&1:5,10|
  O=C1[C@@H]2CC=CC[C@@H]2C(=O)C2C=CC=CC1=2 |&1:2,7|
Test 3
  CC(=O)O[C@@H]1[C@@H](O)[C@H](O)[C@@H](O)[C@H](O)[C@H]1O
  O[C@H]1[C@H](O)[C@@H](O)[C@H](OC(=O)C2CCCCC2)[C@@H](O)[C@@H]1O
Test 4
  NCC1OC1C(=O)NCC1OC1C(O)=O
Test 5
  CC(=O)O[C@@H]1O[C@H](CO)[C@@H](O)[C@H](O)[C@H]1O
  CC(=O)O[C@@H]1[C@@H](CO)O[C@@H](O)[C@H](O)[C@H]1O
  CC(=O)O[C@@H]1[C@@H](O)[C@H](O)O[C@H](CO)[C@H]1O
  CC(=O)O[C@@H]1[C@@H](O)[C@H](O)[C@@H](CO)O[C@H]1O
Test 6
  C[C@@H](Cl)N(C)S
  C[C@@H](Cl)[N@@](C)S |&1:1,&2:3|
  C[C@@H](Cl)[N@@](C)S |&1:1,o1:3|
  C[C@H](Cl)N(C)S
Test 7
  C[N@@](S)/C=C/[C@H](O)Cl
  N/C=C/O
  N/C=C\O
Test 8
  NCC(=O)NCCCC[C@@H](N)C(O)=O |&1:9|
  NCCCC[C@@H](N)C(=O)NCC(O)=O |&1:5|
  NCCCC[C@@H](NC(=O)CN)C(O)=O |&1:5|
Test 9
  N[C@H]1CCC[C@H]1C(=O)N(C(C1C=CC(=CC=1)[N+]([O-])=O)C(=O)NC1CCCCC1)[C@H]1CCC[C@H]1C(O)=O

*** Test set ***
('rpe-multistep-reactions', '0')
('rpe-mode', 'grid')
('rpe-self-reaction', '0')
('rpe-max-depth', '3')
('rpe-max-products-count', '10')
Test 1
  CC=CC(=O)NC1CCCC1
  CC=CC(=O)NCC
  CC=CC(=O)N[C@@H](C)CC
  CCNC(=O)C=CC(O)=O
  C[C@@H](C(=O)NCC)C1C=CC=CC=1 |&1:1|
  C[C@@H](C(=O)N[C@@H](C)CC)C1C=CC=CC=1 |&1:1,a:5|
  C[C@@H](C1=CC=CC=C1)C(=O)NC1CCCC1 |&1:1|
  C[C@@H](CC)NC(=O)C=CC(O)=O
  OC(=O)C=CC(=O)NC1CCCC1
Test 1_aam
  C/C=C/C(=O)NC1CCCC1
  C/C=C/C(=O)NCC
  C/C=C/C(=O)N[C@@H](C)CC
  CCNC(=O)/C=C\C(O)=O
  C[C@@H](C(=O)NCC)C1C=CC=CC=1 |&1:1|
  C[C@@H](C(=O)N[C@@H](C)CC)C1C=CC=CC=1 |&1:1,a:5|
  C[C@@H](C1=CC=CC=C1)C(=O)NC1CCCC1 |&1:1|
  C[C@@H](CC)NC(=O)/C=C\C(O)=O
  OC(=O)/C=C\C(=O)NC1CCCC1
Test 2
  CC1C=CC[C@@H]2[C@H]1C(=O)C1C=CC=CC=1C2=O |&1:5,6|
  CC1C=CC[C@@H]2[C@H]1C(=O)C=CC2=O |&1:5,6|
  CC1C=CC[C@@H]2[C@H]1C(=O)OC2=O |&1:5,6|
  CC1C=CC[C@@H]2[C@H]1CCC2=O |&1:5,6|
  C[C@@H]1CC=CC[C@]1(C)C=O |&1:1,6|
  C[C@@]1(CC=CC[C@]1(C)F)C=O |&1:1,6|
  O=C1C=CC(=O)[C@@H]2CC=CC[C@H]12 |&1:6,11|
  O=C1CC[C@@H]2CC=CC[C@H]12 |&1:4,9|
  O=C1OC(=O)[C@@H]2CC=CC[C@H]12 |&1:5,10|
  O=C1[C@@H]2CC=CC[C@@H]2C(=O)C2C=CC=CC1=2 |&1:2,7|
Test 3
  CC(=O)O[C@@H]1[C@@H](O)[C@H](O)[C@@H](O)[C@H](O)[C@H]1O
  O[C@H]1[C@H](O)[C@@H](O)[C@H](OC(=O)C2CCCCC2)[C@@H](O)[C@@H]1O
Test 4
  NCC1OC1C(=O)NCC1OC1C(O)=O
Test 5
  CC(=O)OC[C@H]1O[C@@H](O)[C@H](O)[C@@H](O)[C@@H]1O
  CC(=O)O[C@@H]1O[C@H](CO)[C@@H](O)[C@H](O)[C@H]1O
  CC(=O)O[C@@H]1[C@@H](CO)O[C@@H](O)[C@H](O)[C@H]1O
  CC(=O)O[C@@H]1[C@@H](O)[C@H](O)O[C@H](CO)[C@H]1O
  CC(=O)O[C@@H]1[C@@H](O)[C@H](O)[C@@H](CO)O[C@H]1O
Test 6
  C[C@@H](Cl)N(C)S
  C[C@@H](Cl)[N@@](C)S |&1:1,&2:3|
  C[C@@H](Cl)[N@@](C)S |&1:1,o1:3|
  C[C@H](Cl)N(C)S
Test 7
  C[N@@](S)/C=C/[C@H](O)Cl
  N/C=C/O
  N/C=C\O
Test 8
  NCC(=O)NCCCC[C@@H](N)C(O)=O |&1:9|
  NCCCC[C@@H](N)C(=O)NCC(O)=O |&1:5|
  NCCCC[C@@H](NC(=O)CN)C(O)=O |&1:5|
Test 9
  N[C@H]1CCC[C@H]1C(=O)N(C(C1C=CC(=CC=1)[N+]([O-])=O)C(=O)NC1CCCCC1)[C@H]1CCC[C@H]1C(O)=O

*** Test set ***
('rpe-multistep-reactions', '0')
('rpe-mode', 'grid')
('rpe-self-reaction', '1')
('rpe-max-depth', '1')
('rpe-max-products-count', '4')
Test 1
  CC=CC(=O)NC1CCCC1
  CC=CC(=O)NCC
  CC=CC(=O)N[C@@H](C)CC
  CCNC(=O)C=CC(O)=O
Test 1_aam
  C/C=C/C(=O)NC1CCCC1
  C/C=C/C(=O)NCC
  C/C=C/C(=O)N[C@@H](C)CC
  CCNC(=O)/C=C\C(O)=O
Test 2
  O=C1C=CC(=O)[C@@H]2CC=CC[C@H]12 |&1:6,11|
  O=C1CC[C@@H]2CC=CC[C@H]12 |&1:4,9|
  O=C1OC(=O)[C@@H]2CC=CC[C@H]12 |&1:5,10|
  O=C1[C@@H]2CC=CC[C@@H]2C(=O)C2C=CC=CC1=2 |&1:2,7|
Test 3
  CC(=O)O[C@@H]1[C@@H](O)[C@H](O)[C@@H](O)[C@H](O)[C@H]1O
  O[C@H]1[C@H](O)[C@@H](O)[C@H](OC(=O)C2CCCCC2)[C@@H](O)[C@@H]1O
Test 4
  NCC1OC1C(=O)NCC1OC1C(O)=O
Test 5
  CC(=O)O[C@@H]1O[C@H](CO)[C@@H](O)[C@H](O)[C@H]1O
  CC(=O)O[C@@H]1[C@@H](CO)O[C@@H](O)[C@H](O)[C@H]1O
  CC(=O)O[C@@H]1[C@@H](O)[C@H](O)O[C@H](CO)[C@H]1O
  CC(=O)O[C@@H]1[C@@H](O)[C@H](O)[C@@H](CO)O[C@H]1O
Test 6
  C[C@@H](Cl)N(C)S
  C[C@@H](Cl)[N@@](C)S |&1:1,&2:3|
  C[C@@H](Cl)[N@@](C)S |&1:1,o1:3|
  C[C@H](Cl)N(C)S
Test 7
  C[N@@](S)/C=C/[C@H](O)Cl
  N/C=C/O
  N/C=C\O
Test 8
  NCC(=O)NCCCC[C@@H](N)C(O)=O |&1:9|
  NCCCC[C@@H](N)C(=O)NCC(O)=O |&1:5|
  NCCCC[C@@H](NC(=O)CN)C(O)=O |&1:5|
Test 9
  N[C@H]1CCC[C@H]1C(=O)N(C(C1C=CC(=CC=1)[N+]([O-])=O)C(=O)NC1CCCCC1)[C@H]1CCC[C@H]1C(O)=O

*** Test set ***
('rpe-multistep-reactions', '0')
('rpe-mode', 'grid')
('rpe-self-reaction', '1')
('rpe-max-depth', '1')
('rpe-max-products-count', '10')
Test 1
  CC=CC(=O)NC1CCCC1
  CC=CC(=O)NCC
  CC=CC(=O)N[C@@H](C)CC
  CCNC(=O)C=CC(O)=O
  C[C@@H](C(=O)NCC)C1C=CC=CC=1 |&1:1|
  C[C@@H](C(=O)N[C@@H](C)CC)C1C=CC=CC=1 |&1:1,a:5|
  C[C@@H](C1=CC=CC=C1)C(=O)NC1CCCC1 |&1:1|
  C[C@@H](CC)NC(=O)C=CC(O)=O
  OC(=O)C=CC(=O)NC1CCCC1
Test 1_aam
  C/C=C/C(=O)NC1CCCC1
  C/C=C/C(=O)NCC
  C/C=C/C(=O)N[C@@H](C)CC
  CCNC(=O)/C=C\C(O)=O
  C[C@@H](C(=O)NCC)C1C=CC=CC=1 |&1:1|
  C[C@@H](C(=O)N[C@@H](C)CC)C1C=CC=CC=1 |&1:1,a:5|
  C[C@@H](C1=CC=CC=C1)C(=O)NC1CCCC1 |&1:1|
  C[C@@H](CC)NC(=O)/C=C\C(O)=O
  OC(=O)/C=C\C(=O)NC1CCCC1
Test 2
  CC1C=CC[C@@H]2[C@H]1C(=O)C1C=CC=CC=1C2=O |&1:5,6|
  CC1C=CC[C@@H]2[C@H]1C(=O)C=CC2=O |&1:5,6|
  CC1C=CC[C@@H]2[C@H]1C(=O)OC2=O |&1:5,6|
  CC1C=CC[C@@H]2[C@H]1CCC2=O |&1:5,6|
  C[C@@H]1CC=CC[C@]1(C)C=O |&1:1,6|
  C[C@@]1(CC=CC[C@]1(C)F)C=O |&1:1,6|
  O=C1C=CC(=O)[C@@H]2CC=CC[C@H]12 |&1:6,11|
  O=C1CC[C@@H]2CC=CC[C@H]12 |&1:4,9|
  O=C1OC(=O)[C@@H]2CC=CC[C@H]12 |&1:5,10|
  O=C1[C@@H]2CC=CC[C@@H]2C(=O)C2C=CC=CC1=2 |&1:2,7|
Test 3
  CC(=O)O[C@@H]1[C@@H](O)[C@H](O)[C@@H](O)[C@H](O)[C@H]1O
  O[C@H]1[C@H](O)[C@@H](O)[C@H](OC(=O)C2CCCCC2)[C@@H](O)[C@@H]1O
Test 4
  NCC1OC1C(=O)NCC1OC1C(O)=O
Test 5
  CC(=O)OC[C@H]1O[C@@H](O)[C@H](O)[C@@H](O)[C@@H]1O
  CC(=O)O[C@@H]1O[C@H](CO)[C@@H](O)[C@H](O)[C@H]1O
  CC(=O)O[C@@H]1[C@@H](CO)O[C@@H](O)[C@H](O)[C@H]1O
  CC(=O)O[C@@H]1[C@@H](O)[C@H](O)O[C@H](CO)[C@H]1O
  CC(=O)O[C@@H]1[C@@H](O)[C@H](O)[C@@H](CO)O[C@H]1O
Test 6
  C[C@@H](Cl)N(C)S
  C[C@@H](Cl)[N@@](C)S |&1:1,&2:3|
  C[C@@H](Cl)[N@@](C)S |&1:1,o1:3|
  C[C@H](Cl)N(C)S
Test 7
  C[N@@](S)/C=C/[C@H](O)Cl
  N/C=C/O
  N/C=C\O
Test 8
  NCC(=O)NCCCC[C@@H](N)C(O)=O |&1:9|
  NCCCC[C@@H](N)C(=O)NCC(O)=O |&1:5|
  NCCCC[C@@H](NC(=O)CN)C(O)=O |&1:5|
Test 9
  N[C@H]1CCC[C@H]1C(=O)N(C(C1C=CC(=CC=1)[N+]([O-])=O)C(=O)NC1CCCCC1)[C@H]1CCC[C@H]1C(O)=O

*** Test set ***
('rpe-multistep-reactions', '0')
('rpe-mode', 'grid')
('rpe-self-reaction', '1')
('rpe-max-depth', '3')
('rpe-max-products-count', '4')
Test 1
  CC=CC(=O)NC1CCCC1
  CC=CC(=O)NCC
  CC=CC(=O)N[C@@H](C)CC
  CCNC(=O)C=CC(O)=O
Test 1_aam
  C/C=C/C(=O)NC1CCCC1
  C/C=C/C(=O)NCC
  C/C=C/C(=O)N[C@@H](C)CC
  CCNC(=O)/C=C\C(O)=O
Test 2
  O=C1C=CC(=O)[C@@H]2CC=CC[C@H]12 |&1:6,11|
  O=C1CC[C@@H]2CC=CC[C@H]12 |&1:4,9|
  O=C1OC(=O)[C@@H]2CC=CC[C@H]12 |&1:5,10|
  O=C1[C@@H]2CC=CC[C@@H]2C(=O)C2C=CC=CC1=2 |&1:2,7|
Test 3
  CC(=O)O[C@@H]1[C@@H](O)[C@H](O)[C@@H](O)[C@H](O)[C@H]1O
  O[C@H]1[C@H](O)[C@@H](O)[C@H](OC(=O)C2CCCCC2)[C@@H](O)[C@@H]1O
Test 4
  NCC1OC1C(=O)NCC1OC1C(O)=O
Test 5
  CC(=O)O[C@@H]1O[C@H](CO)[C@@H](O)[C@H](O)[C@H]1O
  CC(=O)O[C@@H]1[C@@H](CO)O[C@@H](O)[C@H](O)[C@H]1O
  CC(=O)O[C@@H]1[C@@H](O)[C@H](O)O[C@H](CO)[C@H]1O
  CC(=O)O[C@@H]1[C@@H](O)[C@H](O)[C@@H](CO)O[C@H]1O
Test 6
  C[C@@H](Cl)N(C)S
  C[C@@H](Cl)[N@@](C)S |&1:1,&2:3|
  C[C@@H](Cl)[N@@](C)S |&1:1,o1:3|
  C[C@H](Cl)N(C)S
Test 7
  C[N@@](S)/C=C/[C@H](O)Cl
  N/C=C/O
  N/C=C\O
Test 8
  NCC(=O)NCCCC[C@@H](N)C(O)=O |&1:9|
  NCCCC[C@@H](N)C(=O)NCC(O)=O |&1:5|
  NCCCC[C@@H](NC(=O)CN)C(O)=O |&1:5|
Test 9
  N[C@H]1CCC[C@H]1C(=O)N(C(C1C=CC(=CC=1)[N+]([O-])=O)C(=O)NC1CCCCC1)[C@H]1CCC[C@H]1C(O)=O

*** Test set ***
('rpe-multistep-reactions', '0')
('rpe-mode', 'grid')
('rpe-self-reaction', '1')
('rpe-max-depth', '3')
('rpe-max-products-count', '10')
Test 1
  CC=CC(=O)NC1CCCC1
  CC=CC(=O)NCC
  CC=CC(=O)N[C@@H](C)CC
  CCNC(=O)C=CC(O)=O
  C[C@@H](C(=O)NCC)C1C=CC=CC=1 |&1:1|
  C[C@@H](C(=O)N[C@@H](C)CC)C1C=CC=CC=1 |&1:1,a:5|
  C[C@@H](C1=CC=CC=C1)C(=O)NC1CCCC1 |&1:1|
  C[C@@H](CC)NC(=O)C=CC(O)=O
  OC(=O)C=CC(=O)NC1CCCC1
Test 1_aam
  C/C=C/C(=O)NC1CCCC1
  C/C=C/C(=O)NCC
  C/C=C/C(=O)N[C@@H](C)CC
  CCNC(=O)/C=C\C(O)=O
  C[C@@H](C(=O)NCC)C1C=CC=CC=1 |&1:1|
  C[C@@H](C(=O)N[C@@H](C)CC)C1C=CC=CC=1 |&1:1,a:5|
  C[C@@H](C1=CC=CC=C1)C(=O)NC1CCCC1 |&1:1|
  C[C@@H](CC)NC(=O)/C=C\C(O)=O
  OC(=O)/C=C\C(=O)NC1CCCC1
Test 2
  CC1C=CC[C@@H]2[C@H]1C(=O)C1C=CC=CC=1C2=O |&1:5,6|
  CC1C=CC[C@@H]2[C@H]1C(=O)C=CC2=O |&1:5,6|
  CC1C=CC[C@@H]2[C@H]1C(=O)OC2=O |&1:5,6|
  CC1C=CC[C@@H]2[C@H]1CCC2=O |&1:5,6|
  C[C@@H]1CC=CC[C@]1(C)C=O |&1:1,6|
  C[C@@]1(CC=CC[C@]1(C)F)C=O |&1:1,6|
  O=C1C=CC(=O)[C@@H]2CC=CC[C@H]12 |&1:6,11|
  O=C1CC[C@@H]2CC=CC[C@H]12 |&1:4,9|
  O=C1OC(=O)[C@@H]2CC=CC[C@H]12 |&1:5,10|
  O=C1[C@@H]2CC=CC[C@@H]2C(=O)C2C=CC=CC1=2 |&1:2,7|
Test 3
  CC(=O)O[C@@H]1[C@@H](O)[C@H](O)[C@@H](O)[C@H](O)[C@H]1O
  O[C@H]1[C@H](O)[C@@H](O)[C@H](OC(=O)C2CCCCC2)[C@@H](O)[C@@H]1O
Test 4
  NCC1OC1C(=O)NCC1OC1C(O)=O
Test 5
  CC(=O)OC[C@H]1O[C@@H](O)[C@H](O)[C@@H](O)[C@@H]1O
  CC(=O)O[C@@H]1O[C@H](CO)[C@@H](O)[C@H](O)[C@H]1O
  CC(=O)O[C@@H]1[C@@H](CO)O[C@@H](O)[C@H](O)[C@H]1O
  CC(=O)O[C@@H]1[C@@H](O)[C@H](O)O[C@H](CO)[C@H]1O
  CC(=O)O[C@@H]1[C@@H](O)[C@H](O)[C@@H](CO)O[C@H]1O
Test 6
  C[C@@H](Cl)N(C)S
  C[C@@H](Cl)[N@@](C)S |&1:1,&2:3|
  C[C@@H](Cl)[N@@](C)S |&1:1,o1:3|
  C[C@H](Cl)N(C)S
Test 7
  C[N@@](S)/C=C/[C@H](O)Cl
  N/C=C/O
  N/C=C\O
Test 8
  NCC(=O)NCCCC[C@@H](N)C(O)=O |&1:9|
  NCCCC[C@@H](N)C(=O)NCC(O)=O |&1:5|
  NCCCC[C@@H](NC(=O)CN)C(O)=O |&1:5|
Test 9
  N[C@H]1CCC[C@H]1C(=O)N(C(C1C=CC(=CC=1)[N+]([O-])=O)C(=O)NC1CCCCC1)[C@H]1CCC[C@H]1C(O)=O

*** Test set ***
('rpe-multistep-reactions', '0')
('rpe-mode', 'one-tube')
('rpe-self-reaction', '0')
('rpe-max-depth', '1')
('rpe-max-products-count', '4')
Test 1
  CC=CC(=O)NC1CCCC1
  CC=CC(=O)NCC
  CC=CC(=O)N[C@@H](C)CC
  CCNC(=O)C=CC(O)=O
Test 1_aam
  C/C=C/C(=O)NC1CCCC1
  C/C=C/C(=O)NCC
  C/C=C/C(=O)N[C@@H](C)CC
  CCNC(=O)/C=C\C(O)=O
Test 2
  O=C1C=CC(=O)[C@@H]2CC=CC[C@H]12 |&1:6,11|
  O=C1CC[C@@H]2CC=CC[C@H]12 |&1:4,9|
  O=C1OC(=O)[C@@H]2CC=CC[C@H]12 |&1:5,10|
  O=C1[C@@H]2CC=CC[C@@H]2C(=O)C2C=CC=CC1=2 |&1:2,7|
Test 3
  CC(=O)O[C@@H]1[C@@H](O)[C@H](O)[C@@H](O)[C@H](O)[C@H]1O
  O[C@H]1[C@H](O)[C@@H](O)[C@H](OC(=O)C2CCCCC2)[C@@H](O)[C@@H]1O
Test 4
  NCC1OC1C(=O)NCC1OC1C(O)=O
Test 5
  CC(=O)O[C@@H]1O[C@H](CO)[C@@H](O)[C@H](O)[C@H]1O
  CC(=O)O[C@@H]1[C@@H](CO)O[C@@H](O)[C@H](O)[C@H]1O
  CC(=O)O[C@@H]1[C@@H](O)[C@H](O)O[C@H](CO)[C@H]1O
  CC(=O)O[C@@H]1[C@@H](O)[C@H](O)[C@@H](CO)O[C@H]1O
Test 6
  C[C@@H](Cl)N(C)S
  C[C@@H](Cl)[N@@](C)S |&1:1,&2:3|
  C[C@@H](Cl)[N@@](C)S |&1:1,o1:3|
  C[C@H](Cl)N(C)S
Test 7
  C[N@@](S)/C=C/[C@H](O)Cl
  N/C=C/O
  N/C=C\O
Test 8
  NCC(=O)NCC(O)=O
  NCC(=O)NCCCC[C@@H](N)C(O)=O |&1:9|
  NCCCC[C@@H](N)C(=O)NCC(O)=O |&1:5|
  NCCCC[C@@H](NC(=O)CN)C(O)=O |&1:5|
Test 9
  N[C@H]1CCC[C@H]1C(=O)N(C(C1C=CC(=CC=1)[N+]([O-])=O)C(=O)NC1CCCCC1)[C@H]1CCC[C@H]1C(O)=O
  N[C@H]1CCC[C@H]1C(O)(C(=O)NC1CCCCC1)N([C@H]1CCC[C@H]1C(O)=O)C(=O)[C@@H]1CCC[C@@H]1N

*** Test set ***
('rpe-multistep-reactions', '0')
('rpe-mode', 'one-tube')
('rpe-self-reaction', '0')
('rpe-max-depth', '1')
('rpe-max-products-count', '10')
Test 1
  CC=CC(=O)NC1CCCC1
  CC=CC(=O)NCC
  CC=CC(=O)N[C@@H](C)CC
  CCNC(=O)C=CC(O)=O
  C[C@@H](C(=O)NCC)C1C=CC=CC=1 |&1:1|
  C[C@@H](C(=O)N[C@@H](C)CC)C1C=CC=CC=1 |&1:1,a:5|
  C[C@@H](C1=CC=CC=C1)C(=O)NC1CCCC1 |&1:1|
  C[C@@H](CC)NC(=O)C=CC(O)=O
  OC(=O)C=CC(=O)NC1CCCC1
Test 1_aam
  C/C=C/C(=O)NC1CCCC1
  C/C=C/C(=O)NCC
  C/C=C/C(=O)N[C@@H](C)CC
  CCNC(=O)/C=C\C(O)=O
  C[C@@H](C(=O)NCC)C1C=CC=CC=1 |&1:1|
  C[C@@H](C(=O)N[C@@H](C)CC)C1C=CC=CC=1 |&1:1,a:5|
  C[C@@H](C1=CC=CC=C1)C(=O)NC1CCCC1 |&1:1|
  C[C@@H](CC)NC(=O)/C=C\C(O)=O
  OC(=O)/C=C\C(=O)NC1CCCC1
Test 2
  CC1C=CC[C@@H]2[C@H]1C(=O)C1C=CC=CC=1C2=O |&1:5,6|
  CC1C=CC[C@@H]2[C@H]1C(=O)C=CC2=O |&1:5,6|
  CC1C=CC[C@@H]2[C@H]1C(=O)OC2=O |&1:5,6|
  CC1C=CC[C@@H]2[C@H]1CCC2=O |&1:5,6|
  C[C@@H]1CC=CC[C@]1(C)C=O |&1:1,6|
  C[C@@]1(CC=CC[C@]1(C)F)C=O |&1:1,6|
  O=C1C=CC(=O)[C@@H]2CC=CC[C@H]12 |&1:6,11|
  O=C1CC[C@@H]2CC=CC[C@H]12 |&1:4,9|
  O=C1OC(=O)[C@@H]2CC=CC[C@H]12 |&1:5,10|
  O=C1[C@@H]2CC=CC[C@@H]2C(=O)C2C=CC=CC1=2 |&1:2,7|
Test 3
  CC(=O)O[C@@H]1[C@@H](O)[C@H](O)[C@@H](O)[C@H](O)[C@H]1O
  O[C@H]1[C@H](O)[C@@H](O)[C@H](OC(=O)C2CCCCC2)[C@@H](O)[C@@H]1O
Test 4
  NCC1OC1C(=O)NCC1OC1C(O)=O
Test 5
  CC(=O)OC[C@H]1O[C@@H](O)[C@H](O)[C@@H](O)[C@@H]1O
  CC(=O)O[C@@H]1O[C@H](CO)[C@@H](O)[C@H](O)[C@H]1O
  CC(=O)O[C@@H]1[C@@H](CO)O[C@@H](O)[C@H](O)[C@H]1O
  CC(=O)O[C@@H]1[C@@H](O)[C@H](O)O[C@H](CO)[C@H]1O
  CC(=O)O[C@@H]1[C@@H](O)[C@H](O)[C@@H](CO)O[C@H]1O
Test 6
  C[C@@H](Cl)N(C)S
  C[C@@H](Cl)[N@@](C)S |&1:1,&2:3|
  C[C@@H](Cl)[N@@](C)S |&1:1,o1:3|
  C[C@H](Cl)N(C)S
Test 7
  C[N@@](S)/C=C/[C@H](O)Cl
  N/C=C/O
  N/C=C\O
Test 8
  NCC(=O)NCC(O)=O
  NCC(=O)NCCCC[C@@H](N)C(O)=O |&1:9|
  NCCCC[C@@H](N)C(=O)NCC(O)=O |&1:5|
  NCCCC[C@@H](N)C(=O)NCCCC[C@@H](N)C(O)=O |&1:5,14|
  NCCCC[C@@H](NC(=O)CN)C(O)=O |&1:5|
  N[C@@H](CCCCN)C(=O)N[C@H](CCCCN)C(O)=O |&1:1,10|
Test 9
  N[C@H]1CCC[C@H]1C(=O)N(C(C1C=CC(=CC=1)[N+]([O-])=O)C(=O)NC1CCCCC1)[C@H]1CCC[C@H]1C(O)=O
  N[C@H]1CCC[C@H]1C(O)(C(=O)NC1CCCCC1)N([C@H]1CCC[C@H]1C(O)=O)C(=O)[C@@H]1CCC[C@@H]1N

*** Test set ***
('rpe-multistep-reactions', '0')
('rpe-mode', 'one-tube')
('rpe-self-reaction', '0')
('rpe-max-depth', '3')
('rpe-max-products-count', '4')
Test 1
  CC=CC(=O)NC1CCCC1
  CC=CC(=O)NCC
  CC=CC(=O)N[C@@H](C)CC
  CCNC(=O)C=CC(O)=O
Test 1_aam
  C/C=C/C(=O)NC1CCCC1
  C/C=C/C(=O)NCC
  C/C=C/C(=O)N[C@@H](C)CC
  CCNC(=O)/C=C\C(O)=O
Test 2
  O=C1C=CC(=O)[C@@H]2CC=CC[C@H]12 |&1:6,11|
  O=C1CC[C@@H]2CC=CC[C@H]12 |&1:4,9|
  O=C1OC(=O)[C@@H]2CC=CC[C@H]12 |&1:5,10|
  O=C1[C@@H]2CC=CC[C@@H]2C(=O)C2C=CC=CC1=2 |&1:2,7|
Test 3
  CC(=O)O[C@@H]1[C@@H](O)[C@H](O)[C@@H](O)[C@H](O)[C@H]1O
  O[C@H]1[C@H](O)[C@@H](O)[C@H](OC(=O)C2CCCCC2)[C@@H](O)[C@@H]1O
Test 4
  NCC1OC1C(=O)NCC1OC1C(O)=O
Test 5
  CC(=O)O[C@@H]1O[C@H](CO)[C@@H](O)[C@H](O)[C@H]1O
  CC(=O)O[C@@H]1[C@@H](CO)O[C@@H](O)[C@H](O)[C@H]1O
  CC(=O)O[C@@H]1[C@@H](O)[C@H](O)O[C@H](CO)[C@H]1O
  CC(=O)O[C@@H]1[C@@H](O)[C@H](O)[C@@H](CO)O[C@H]1O
Test 6
  C[C@@H](Cl)N(C)S
  C[C@@H](Cl)[N@@](C)S |&1:1,&2:3|
  C[C@@H](Cl)[N@@](C)S |&1:1,o1:3|
  C[C@H](Cl)N(C)S
Test 7
  C[N@@](S)/C=C/[C@H](O)Cl
  N/C=C/O
  N/C=C\O
Test 8
  NCC(=O)NCC(O)=O
  NCC(=O)NCCCC[C@@H](N)C(O)=O |&1:9|
  NCCCC[C@@H](N)C(=O)NCC(O)=O |&1:5|
  NCCCC[C@@H](NC(=O)CN)C(O)=O |&1:5|
Test 9
  N[C@H]1CCC[C@H]1C(=O)N(C(C1C=CC(=CC=1)[N+]([O-])=O)C(=O)NC1CCCCC1)[C@H]1CCC[C@H]1C(O)=O
  N[C@H]1CCC[C@H]1C(O)(C(=O)NC1CCCCC1)N([C@H]1CCC[C@H]1C(O)=O)C(=O)[C@@H]1CCC[C@@H]1N

*** Test set ***
('rpe-multistep-reactions', '0')
('rpe-mode', 'one-tube')
('rpe-self-reaction', '0')
('rpe-max-depth', '3')
('rpe-max-products-count', '10')
Test 1
  CC=CC(=O)NC1CCCC1
  CC=CC(=O)NCC
  CC=CC(=O)N[C@@H](C)CC
  CCNC(=O)C=CC(O)=O
  C[C@@H](C(=O)NCC)C1C=CC=CC=1 |&1:1|
  C[C@@H](C(=O)N[C@@H](C)CC)C1C=CC=CC=1 |&1:1,a:5|
  C[C@@H](C1=CC=CC=C1)C(=O)NC1CCCC1 |&1:1|
  C[C@@H](CC)NC(=O)C=CC(O)=O
  OC(=O)C=CC(=O)NC1CCCC1
Test 1_aam
  C/C=C/C(=O)NC1CCCC1
  C/C=C/C(=O)NCC
  C/C=C/C(=O)N[C@@H](C)CC
  CCNC(=O)/C=C\C(O)=O
  C[C@@H](C(=O)NCC)C1C=CC=CC=1 |&1:1|
  C[C@@H](C(=O)N[C@@H](C)CC)C1C=CC=CC=1 |&1:1,a:5|
  C[C@@H](C1=CC=CC=C1)C(=O)NC1CCCC1 |&1:1|
  C[C@@H](CC)NC(=O)/C=C\C(O)=O
  OC(=O)/C=C\C(=O)NC1CCCC1
Test 2
  CC1C=CC[C@@H]2[C@H]1C(=O)C1C=CC=CC=1C2=O |&1:5,6|
  CC1C=CC[C@@H]2[C@H]1C(=O)C=CC2=O |&1:5,6|
  CC1C=CC[C@@H]2[C@H]1C(=O)OC2=O |&1:5,6|
  CC1C=CC[C@@H]2[C@H]1CCC2=O |&1:5,6|
  C[C@@H]1CC=CC[C@]1(C)C=O |&1:1,6|
  C[C@@]1(CC=CC[C@]1(C)F)C=O |&1:1,6|
  O=C1C=CC(=O)[C@@H]2CC=CC[C@H]12 |&1:6,11|
  O=C1CC[C@@H]2CC=CC[C@H]12 |&1:4,9|
  O=C1OC(=O)[C@@H]2CC=CC[C@H]12 |&1:5,10|
  O=C1[C@@H]2CC=CC[C@@H]2C(=O)C2C=CC=CC1=2 |&1:2,7|
Test 3
  CC(=O)O[C@@H]1[C@@H](O)[C@H](O)[C@@H](O)[C@H](O)[C@H]1O
  O[C@H]1[C@H](O)[C@@H](O)[C@H](OC(=O)C2CCCCC2)[C@@H](O)[C@@H]1O
Test 4
  NCC1OC1C(=O)NCC1OC1C(O)=O
Test 5
  CC(=O)OC[C@H]1O[C@@H](O)[C@H](O)[C@@H](O)[C@@H]1O
  CC(=O)O[C@@H]1O[C@H](CO)[C@@H](O)[C@H](O)[C@H]1O
  CC(=O)O[C@@H]1[C@@H](CO)O[C@@H](O)[C@H](O)[C@H]1O
  CC(=O)O[C@@H]1[C@@H](O)[C@H](O)O[C@H](CO)[C@H]1O
  CC(=O)O[C@@H]1[C@@H](O)[C@H](O)[C@@H](CO)O[C@H]1O
Test 6
  C[C@@H](Cl)N(C)S
  C[C@@H](Cl)[N@@](C)S |&1:1,&2:3|
  C[C@@H](Cl)[N@@](C)S |&1:1,o1:3|
  C[C@H](Cl)N(C)S
Test 7
  C[N@@](S)/C=C/[C@H](O)Cl
  N/C=C/O
  N/C=C\O
Test 8
  NCC(=O)NCC(O)=O
  NCC(=O)NCCCC[C@@H](N)C(O)=O |&1:9|
  NCCCC[C@@H](N)C(=O)NCC(O)=O |&1:5|
  NCCCC[C@@H](N)C(=O)NCCCC[C@@H](N)C(O)=O |&1:5,14|
  NCCCC[C@@H](NC(=O)CN)C(O)=O |&1:5|
  N[C@@H](CCCCN)C(=O)N[C@H](CCCCN)C(O)=O |&1:1,10|
Test 9
  N[C@H]1CCC[C@H]1C(=O)N(C(C1C=CC(=CC=1)[N+]([O-])=O)C(=O)NC1CCCCC1)[C@H]1CCC[C@H]1C(O)=O
  N[C@H]1CCC[C@H]1C(O)(C(=O)NC1CCCCC1)N([C@H]1CCC[C@H]1C(O)=O)C(=O)[C@@H]1CCC[C@@H]1N

*** Test set ***
('rpe-multistep-reactions', '0')
('rpe-mode', 'one-tube')
('rpe-self-reaction', '1')
('rpe-max-depth', '1')
('rpe-max-products-count', '4')
Test 1
  CC=CC(=O)NC1CCCC1
  CC=CC(=O)NCC
  CC=CC(=O)N[C@@H](C)CC
  CCNC(=O)C=CC(O)=O
Test 1_aam
  C/C=C/C(=O)NC1CCCC1
  C/C=C/C(=O)NCC
  C/C=C/C(=O)N[C@@H](C)CC
  CCNC(=O)/C=C\C(O)=O
Test 2
  O=C1C=CC(=O)[C@@H]2CC=CC[C@H]12 |&1:6,11|
  O=C1CC[C@@H]2CC=CC[C@H]12 |&1:4,9|
  O=C1OC(=O)[C@@H]2CC=CC[C@H]12 |&1:5,10|
  O=C1[C@@H]2CC=CC[C@@H]2C(=O)C2C=CC=CC1=2 |&1:2,7|
Test 3
  CC(=O)O[C@@H]1[C@@H](O)[C@H](O)[C@@H](O)[C@H](O)[C@H]1O
  O[C@H]1[C@H](O)[C@@H](O)[C@H](OC(=O)C2CCCCC2)[C@@H](O)[C@@H]1O
Test 4
  NCC1OC1C(=O)NCC1OC1C(O)=O
  O=C1NCC2OC12
Test 5
  CC(=O)O[C@@H]1O[C@H](CO)[C@@H](O)[C@H](O)[C@H]1O
  CC(=O)O[C@@H]1[C@@H](CO)O[C@@H](O)[C@H](O)[C@H]1O
  CC(=O)O[C@@H]1[C@@H](O)[C@H](O)O[C@H](CO)[C@H]1O
  CC(=O)O[C@@H]1[C@@H](O)[C@H](O)[C@@H](CO)O[C@H]1O
Test 6
  C[C@@H](Cl)N(C)S
  C[C@@H](Cl)[N@@](C)S |&1:1,&2:3|
  C[C@@H](Cl)[N@@](C)S |&1:1,o1:3|
  C[C@H](Cl)N(C)S
Test 7
  C[N@@](S)/C=C/[C@H](O)Cl
  N/C=C/O
  N/C=C\O
Test 8
  NCC(=O)NCC(O)=O
  NCC(=O)NCCCC[C@@H](N)C(O)=O |&1:9|
  NCCCC[C@@H](N)C(=O)NCC(O)=O |&1:5|
  NCCCC[C@@H](NC(=O)CN)C(O)=O |&1:5|
Test 9
  N[C@H]1CCC[C@H]1C(=O)N(C(C1C=CC(=CC=1)[N+]([O-])=O)C(=O)NC1CCCCC1)[C@H]1CCC[C@H]1C(O)=O
  N[C@H]1CCC[C@H]1C(=O)N1[C@H]2CCC[C@H]2C1(O)C(=O)NC1CCCCC1
  N[C@H]1CCC[C@H]1C(O)(C(=O)NC1CCCCC1)N1[C@H]2CCC[C@H]2C1=O
  [O-][N+](=O)C1=CC=C(C=C1)C(C(=O)NC1CCCCC1)N1[C@H]2CCC[C@H]2C1=O

*** Test set ***
('rpe-multistep-reactions', '0')
('rpe-mode', 'one-tube')
('rpe-self-reaction', '1')
('rpe-max-depth', '1')
('rpe-max-products-count', '10')
Test 1
  CC=CC(=O)NC1CCCC1
  CC=CC(=O)NCC
  CC=CC(=O)N[C@@H](C)CC
  CCNC(=O)C=CC(O)=O
  C[C@@H](C(=O)NCC)C1C=CC=CC=1 |&1:1|
  C[C@@H](C(=O)N[C@@H](C)CC)C1C=CC=CC=1 |&1:1,a:5|
  C[C@@H](C1=CC=CC=C1)C(=O)NC1CCCC1 |&1:1|
  C[C@@H](CC)NC(=O)C=CC(O)=O
  OC(=O)C=CC(=O)NC1CCCC1
Test 1_aam
  C/C=C/C(=O)NC1CCCC1
  C/C=C/C(=O)NCC
  C/C=C/C(=O)N[C@@H](C)CC
  CCNC(=O)/C=C\C(O)=O
  C[C@@H](C(=O)NCC)C1C=CC=CC=1 |&1:1|
  C[C@@H](C(=O)N[C@@H](C)CC)C1C=CC=CC=1 |&1:1,a:5|
  C[C@@H](C1=CC=CC=C1)C(=O)NC1CCCC1 |&1:1|
  C[C@@H](CC)NC(=O)/C=C\C(O)=O
  OC(=O)/C=C\C(=O)NC1CCCC1
Test 2
  CC1C=CC[C@@H]2[C@H]1C(=O)C1C=CC=CC=1C2=O |&1:5,6|
  CC1C=CC[C@@H]2[C@H]1C(=O)C=CC2=O |&1:5,6|
  CC1C=CC[C@@H]2[C@H]1C(=O)OC2=O |&1:5,6|
  CC1C=CC[C@@H]2[C@H]1CCC2=O |&1:5,6|
  C[C@@H]1CC=CC[C@]1(C)C=O |&1:1,6|
  C[C@@]1(CC=CC[C@]1(C)F)C=O |&1:1,6|
  O=C1C=CC(=O)[C@@H]2CC=CC[C@H]12 |&1:6,11|
  O=C1CC[C@@H]2CC=CC[C@H]12 |&1:4,9|
  O=C1OC(=O)[C@@H]2CC=CC[C@H]12 |&1:5,10|
  O=C1[C@@H]2CC=CC[C@@H]2C(=O)C2C=CC=CC1=2 |&1:2,7|
Test 3
  CC(=O)O[C@@H]1[C@@H](O)[C@H](O)[C@@H](O)[C@H](O)[C@H]1O
  O[C@H]1[C@H](O)[C@@H](O)[C@H](OC(=O)C2CCCCC2)[C@@H](O)[C@@H]1O
Test 4
  NCC1OC1C(=O)NCC1OC1C(O)=O
  O=C1NCC2OC12
Test 5
  CC(=O)OC[C@H]1O[C@@H](O)[C@H](O)[C@@H](O)[C@@H]1O
  CC(=O)O[C@@H]1O[C@H](CO)[C@@H](O)[C@H](O)[C@H]1O
  CC(=O)O[C@@H]1[C@@H](CO)O[C@@H](O)[C@H](O)[C@H]1O
  CC(=O)O[C@@H]1[C@@H](O)[C@H](O)O[C@H](CO)[C@H]1O
  CC(=O)O[C@@H]1[C@@H](O)[C@H](O)[C@@H](CO)O[C@H]1O
Test 6
  C[C@@H](Cl)N(C)S
  C[C@@H](Cl)[N@@](C)S |&1:1,&2:3|
  C[C@@H](Cl)[N@@](C)S |&1:1,o1:3|
  C[C@H](Cl)N(C)S
Test 7
  C[N@@](S)/C=C/[C@H](O)Cl
  N/C=C/O
  N/C=C\O
Test 8
  NCC(=O)NCC(O)=O
  NCC(=O)NCCCC[C@@H](N)C(O)=O |&1:9|
  NCCCC[C@@H](N)C(=O)NCC(O)=O |&1:5|
  NCCCC[C@@H](N)C(=O)NCCCC[C@@H](N)C(O)=O |&1:5,14|
  NCCCC[C@@H](NC(=O)CN)C(O)=O |&1:5|
  N[C@@H](CCCCN)C(=O)N[C@H](CCCCN)C(O)=O |&1:1,10|
Test 9
  N[C@H]1CCC[C@H]1C(=O)N(C(C1C=CC(=CC=1)[N+]([O-])=O)C(=O)NC1CCCCC1)[C@H]1CCC[C@H]1C(O)=O
  N[C@H]1CCC[C@H]1C(=O)N1[C@H]2CCC[C@H]2C1(O)C(=O)NC1CCCCC1
  N[C@H]1CCC[C@H]1C(O)(C(=O)NC1CCCCC1)N([C@H]1CCC[C@H]1C(O)=O)C(=O)[C@@H]1CCC[C@@H]1N
  N[C@H]1CCC[C@H]1C(O)(C(=O)NC1CCCCC1)N1[C@H]2CCC[C@H]2C1=O
  [O-][N+](=O)C1=CC=C(C=C1)C(C(=O)NC1CCCCC1)N1[C@H]2CCC[C@H]2C1=O

*** Test set ***
('rpe-multistep-reactions', '0')
('rpe-mode', 'one-tube')
('rpe-self-reaction', '1')
('rpe-max-depth', '3')
('rpe-max-products-count', '4')
Test 1
  CC=CC(=O)NC1CCCC1
  CC=CC(=O)NCC
  CC=CC(=O)N[C@@H](C)CC
  CCNC(=O)C=CC(O)=O
Test 1_aam
  C/C=C/C(=O)NC1CCCC1
  C/C=C/C(=O)NCC
  C/C=C/C(=O)N[C@@H](C)CC
  CCNC(=O)/C=C\C(O)=O
Test 2
  O=C1C=CC(=O)[C@@H]2CC=CC[C@H]12 |&1:6,11|
  O=C1CC[C@@H]2CC=CC[C@H]12 |&1:4,9|
  O=C1OC(=O)[C@@H]2CC=CC[C@H]12 |&1:5,10|
  O=C1[C@@H]2CC=CC[C@@H]2C(=O)C2C=CC=CC1=2 |&1:2,7|
Test 3
  CC(=O)O[C@@H]1[C@@H](O)[C@H](O)[C@@H](O)[C@H](O)[C@H]1O
  O[C@H]1[C@H](O)[C@@H](O)[C@H](OC(=O)C2CCCCC2)[C@@H](O)[C@@H]1O
Test 4
  NCC1OC1C(=O)NCC1OC1C(O)=O
  O=C1NCC2OC12
Test 5
  CC(=O)O[C@@H]1O[C@H](CO)[C@@H](O)[C@H](O)[C@H]1O
  CC(=O)O[C@@H]1[C@@H](CO)O[C@@H](O)[C@H](O)[C@H]1O
  CC(=O)O[C@@H]1[C@@H](O)[C@H](O)O[C@H](CO)[C@H]1O
  CC(=O)O[C@@H]1[C@@H](O)[C@H](O)[C@@H](CO)O[C@H]1O
Test 6
  C[C@@H](Cl)N(C)S
  C[C@@H](Cl)[N@@](C)S |&1:1,&2:3|
  C[C@@H](Cl)[N@@](C)S |&1:1,o1:3|
  C[C@H](Cl)N(C)S
Test 7
  C[N@@](S)/C=C/[C@H](O)Cl
  N/C=C/O
  N/C=C\O
Test 8
  NCC(=O)NCC(O)=O
  NCC(=O)NCCCC[C@@H](N)C(O)=O |&1:9|
  NCCCC[C@@H](N)C(=O)NCC(O)=O |&1:5|
  NCCCC[C@@H](NC(=O)CN)C(O)=O |&1:5|
Test 9
  N[C@H]1CCC[C@H]1C(=O)N(C(C1C=CC(=CC=1)[N+]([O-])=O)C(=O)NC1CCCCC1)[C@H]1CCC[C@H]1C(O)=O
  N[C@H]1CCC[C@H]1C(=O)N1[C@H]2CCC[C@H]2C1(O)C(=O)NC1CCCCC1
  N[C@H]1CCC[C@H]1C(O)(C(=O)NC1CCCCC1)N1[C@H]2CCC[C@H]2C1=O
  [O-][N+](=O)C1=CC=C(C=C1)C(C(=O)NC1CCCCC1)N1[C@H]2CCC[C@H]2C1=O

*** Test set ***
('rpe-multistep-reactions', '0')
('rpe-mode', 'one-tube')
('rpe-self-reaction', '1')
('rpe-max-depth', '3')
('rpe-max-products-count', '10')
Test 1
  CC=CC(=O)NC1CCCC1
  CC=CC(=O)NCC
  CC=CC(=O)N[C@@H](C)CC
  CCNC(=O)C=CC(O)=O
  C[C@@H](C(=O)NCC)C1C=CC=CC=1 |&1:1|
  C[C@@H](C(=O)N[C@@H](C)CC)C1C=CC=CC=1 |&1:1,a:5|
  C[C@@H](C1=CC=CC=C1)C(=O)NC1CCCC1 |&1:1|
  C[C@@H](CC)NC(=O)C=CC(O)=O
  OC(=O)C=CC(=O)NC1CCCC1
Test 1_aam
  C/C=C/C(=O)NC1CCCC1
  C/C=C/C(=O)NCC
  C/C=C/C(=O)N[C@@H](C)CC
  CCNC(=O)/C=C\C(O)=O
  C[C@@H](C(=O)NCC)C1C=CC=CC=1 |&1:1|
  C[C@@H](C(=O)N[C@@H](C)CC)C1C=CC=CC=1 |&1:1,a:5|
  C[C@@H](C1=CC=CC=C1)C(=O)NC1CCCC1 |&1:1|
  C[C@@H](CC)NC(=O)/C=C\C(O)=O
  OC(=O)/C=C\C(=O)NC1CCCC1
Test 2
  CC1C=CC[C@@H]2[C@H]1C(=O)C1C=CC=CC=1C2=O |&1:5,6|
  CC1C=CC[C@@H]2[C@H]1C(=O)C=CC2=O |&1:5,6|
  CC1C=CC[C@@H]2[C@H]1C(=O)OC2=O |&1:5,6|
  CC1C=CC[C@@H]2[C@H]1CCC2=O |&1:5,6|
  C[C@@H]1CC=CC[C@]1(C)C=O |&1:1,6|
  C[C@@]1(CC=CC[C@]1(C)F)C=O |&1:1,6|
  O=C1C=CC(=O)[C@@H]2CC=CC[C@H]12 |&1:6,11|
  O=C1CC[C@@H]2CC=CC[C@H]12 |&1:4,9|
  O=C1OC(=O)[C@@H]2CC=CC[C@H]12 |&1:5,10|
  O=C1[C@@H]2CC=CC[C@@H]2C(=O)C2C=CC=CC1=2 |&1:2,7|
Test 3
  CC(=O)O[C@@H]1[C@@H](O)[C@H](O)[C@@H](O)[C@H](O)[C@H]1O
  O[C@H]1[C@H](O)[C@@H](O)[C@H](OC(=O)C2CCCCC2)[C@@H](O)[C@@H]1O
Test 4
  NCC1OC1C(=O)NCC1OC1C(O)=O
  O=C1NCC2OC12
Test 5
  CC(=O)OC[C@H]1O[C@@H](O)[C@H](O)[C@@H](O)[C@@H]1O
  CC(=O)O[C@@H]1O[C@H](CO)[C@@H](O)[C@H](O)[C@H]1O
  CC(=O)O[C@@H]1[C@@H](CO)O[C@@H](O)[C@H](O)[C@H]1O
  CC(=O)O[C@@H]1[C@@H](O)[C@H](O)O[C@H](CO)[C@H]1O
  CC(=O)O[C@@H]1[C@@H](O)[C@H](O)[C@@H](CO)O[C@H]1O
Test 6
  C[C@@H](Cl)N(C)S
  C[C@@H](Cl)[N@@](C)S |&1:1,&2:3|
  C[C@@H](Cl)[N@@](C)S |&1:1,o1:3|
  C[C@H](Cl)N(C)S
Test 7
  C[N@@](S)/C=C/[C@H](O)Cl
  N/C=C/O
  N/C=C\O
Test 8
  NCC(=O)NCC(O)=O
  NCC(=O)NCCCC[C@@H](N)C(O)=O |&1:9|
  NCCCC[C@@H](N)C(=O)NCC(O)=O |&1:5|
  NCCCC[C@@H](N)C(=O)NCCCC[C@@H](N)C(O)=O |&1:5,14|
  NCCCC[C@@H](NC(=O)CN)C(O)=O |&1:5|
  N[C@@H](CCCCN)C(=O)N[C@H](CCCCN)C(O)=O |&1:1,10|
Test 9
  N[C@H]1CCC[C@H]1C(=O)N(C(C1C=CC(=CC=1)[N+]([O-])=O)C(=O)NC1CCCCC1)[C@H]1CCC[C@H]1C(O)=O
  N[C@H]1CCC[C@H]1C(=O)N1[C@H]2CCC[C@H]2C1(O)C(=O)NC1CCCCC1
  N[C@H]1CCC[C@H]1C(O)(C(=O)NC1CCCCC1)N([C@H]1CCC[C@H]1C(O)=O)C(=O)[C@@H]1CCC[C@@H]1N
  N[C@H]1CCC[C@H]1C(O)(C(=O)NC1CCCCC1)N1[C@H]2CCC[C@H]2C1=O
  [O-][N+](=O)C1=CC=C(C=C1)C(C(=O)NC1CCCCC1)N1[C@H]2CCC[C@H]2C1=O

*** Test set ***
('rpe-multistep-reactions', '1')
('rpe-mode', 'grid')
('rpe-self-reaction', '0')
('rpe-max-depth', '1')
('rpe-max-products-count', '4')
Test 1
  CC=CC(=O)NC1CCCC1
  CC=CC(=O)NCC
  CC=CC(=O)N[C@@H](C)CC
  CCNC(=O)C=CC(O)=O
Test 1_aam
  C/C=C/C(=O)NC1CCCC1
  C/C=C/C(=O)NCC
  C/C=C/C(=O)N[C@@H](C)CC
  CCNC(=O)/C=C\C(O)=O
Test 2
  O=C1C=CC(=O)[C@@H]2CC=CC[C@H]12 |&1:6,11|
  O=C1CC[C@@H]2CC=CC[C@H]12 |&1:4,9|
  O=C1OC(=O)[C@@H]2CC=CC[C@H]12 |&1:5,10|
  O=C1[C@@H]2CC=CC[C@@H]2C(=O)C2C=CC=CC1=2 |&1:2,7|
Test 3
  CC(=O)O[C@@H]1[C@@H](O)[C@H](O)[C@@H](O)[C@H](O)[C@H]1O
  O[C@H]1[C@H](O)[C@@H](O)[C@H](OC(=O)C2CCCCC2)[C@@H](O)[C@@H]1O
Test 4
  NCC1OC1C(=O)NCC1OC1C(O)=O
Test 5
  CC(=O)O[C@@H]1O[C@H](CO)[C@@H](O)[C@H](O)[C@H]1O
  CC(=O)O[C@@H]1[C@@H](CO)O[C@@H](O)[C@H](O)[C@H]1O
  CC(=O)O[C@@H]1[C@@H](O)[C@H](O)O[C@H](CO)[C@H]1O
  CC(=O)O[C@@H]1[C@@H](O)[C@H](O)[C@@H](CO)O[C@H]1O
Test 6
  C[C@@H](Cl)N(C)S
  C[C@@H](Cl)[N@@](C)S |&1:1,&2:3|
  C[C@@H](Cl)[N@@](C)S |&1:1,o1:3|
  C[C@H](Cl)N(C)S
Test 7
  C[N@@](S)/C=C/[C@H](O)Cl
  N/C=C/O
  N/C=C\O
Test 8
  NCC(=O)NCCCC[C@@H](N)C(O)=O |&1:9|
  NCCCC[C@@H](N)C(=O)NCC(O)=O |&1:5|
  NCCCC[C@@H](NC(=O)CN)C(O)=O |&1:5|
Test 9
  N[C@H]1CCC[C@H]1C(=O)N(C(C1C=CC(=CC=1)[N+]([O-])=O)C(=O)NC1CCCCC1)[C@H]1CCC[C@H]1C(O)=O

*** Test set ***
('rpe-multistep-reactions', '1')
('rpe-mode', 'grid')
('rpe-self-reaction', '0')
('rpe-max-depth', '1')
('rpe-max-products-count', '10')
Test 1
  CC=CC(=O)NC1CCCC1
  CC=CC(=O)NCC
  CC=CC(=O)N[C@@H](C)CC
  CCNC(=O)C=CC(O)=O
  C[C@@H](C(=O)NCC)C1C=CC=CC=1 |&1:1|
  C[C@@H](C(=O)N[C@@H](C)CC)C1C=CC=CC=1 |&1:1,a:5|
  C[C@@H](C1=CC=CC=C1)C(=O)NC1CCCC1 |&1:1|
  C[C@@H](CC)NC(=O)C=CC(O)=O
  OC(=O)C=CC(=O)NC1CCCC1
Test 1_aam
  C/C=C/C(=O)NC1CCCC1
  C/C=C/C(=O)NCC
  C/C=C/C(=O)N[C@@H](C)CC
  CCNC(=O)/C=C\C(O)=O
  C[C@@H](C(=O)NCC)C1C=CC=CC=1 |&1:1|
  C[C@@H](C(=O)N[C@@H](C)CC)C1C=CC=CC=1 |&1:1,a:5|
  C[C@@H](C1=CC=CC=C1)C(=O)NC1CCCC1 |&1:1|
  C[C@@H](CC)NC(=O)/C=C\C(O)=O
  OC(=O)/C=C\C(=O)NC1CCCC1
Test 2
  CC1C=CC[C@@H]2[C@H]1C(=O)C1C=CC=CC=1C2=O |&1:5,6|
  CC1C=CC[C@@H]2[C@H]1C(=O)C=CC2=O |&1:5,6|
  CC1C=CC[C@@H]2[C@H]1C(=O)OC2=O |&1:5,6|
  CC1C=CC[C@@H]2[C@H]1CCC2=O |&1:5,6|
  C[C@@H]1CC=CC[C@]1(C)C=O |&1:1,6|
  C[C@@]1(CC=CC[C@]1(C)F)C=O |&1:1,6|
  O=C1C=CC(=O)[C@@H]2CC=CC[C@H]12 |&1:6,11|
  O=C1CC[C@@H]2CC=CC[C@H]12 |&1:4,9|
  O=C1OC(=O)[C@@H]2CC=CC[C@H]12 |&1:5,10|
  O=C1[C@@H]2CC=CC[C@@H]2C(=O)C2C=CC=CC1=2 |&1:2,7|
Test 3
  CC(=O)O[C@@H]1[C@@H](O)[C@H](O)[C@@H](O)[C@H](O)[C@H]1O
  O[C@H]1[C@H](O)[C@@H](O)[C@H](OC(=O)C2CCCCC2)[C@@H](O)[C@@H]1O
Test 4
  NCC1OC1C(=O)NCC1OC1C(O)=O
Test 5
  CC(=O)OC[C@H]1O[C@@H](O)[C@H](O)[C@@H](O)[C@@H]1O
  CC(=O)O[C@@H]1O[C@H](CO)[C@@H](O)[C@H](O)[C@H]1O
  CC(=O)O[C@@H]1[C@@H](CO)O[C@@H](O)[C@H](O)[C@H]1O
  CC(=O)O[C@@H]1[C@@H](O)[C@H](O)O[C@H](CO)[C@H]1O
  CC(=O)O[C@@H]1[C@@H](O)[C@H](O)[C@@H](CO)O[C@H]1O
Test 6
  C[C@@H](Cl)N(C)S
  C[C@@H](Cl)[N@@](C)S |&1:1,&2:3|
  C[C@@H](Cl)[N@@](C)S |&1:1,o1:3|
  C[C@H](Cl)N(C)S
Test 7
  C[N@@](S)/C=C/[C@H](O)Cl
  N/C=C/O
  N/C=C\O
Test 8
  NCC(=O)NCCCC[C@@H](N)C(O)=O |&1:9|
  NCCCC[C@@H](N)C(=O)NCC(O)=O |&1:5|
  NCCCC[C@@H](NC(=O)CN)C(O)=O |&1:5|
Test 9
  N[C@H]1CCC[C@H]1C(=O)N(C(C1C=CC(=CC=1)[N+]([O-])=O)C(=O)NC1CCCCC1)[C@H]1CCC[C@H]1C(O)=O

*** Test set ***
('rpe-multistep-reactions', '1')
('rpe-mode', 'grid')
('rpe-self-reaction', '0')
('rpe-max-depth', '3')
('rpe-max-products-count', '4')
Test 1
  CC=CC(=O)NC1CCCC1
  CC=CC(=O)NCC
  CC=CC(=O)N[C@@H](C)CC
  CCNC(=O)C=CC(O)=O
Test 1_aam
  C/C=C/C(=O)NC1CCCC1
  C/C=C/C(=O)NCC
  C/C=C/C(=O)N[C@@H](C)CC
  CCNC(=O)/C=C\C(O)=O
Test 2
  O=C1C=CC(=O)[C@@H]2CC=CC[C@H]12 |&1:6,11|
  O=C1CC[C@@H]2CC=CC[C@H]12 |&1:4,9|
  O=C1OC(=O)[C@@H]2CC=CC[C@H]12 |&1:5,10|
  O=C1[C@@H]2CC=CC[C@@H]2C(=O)C2C=CC=CC1=2 |&1:2,7|
Test 3
  CC(=O)O[C@@H]1[C@@H](O)[C@H](O)[C@@H](O)[C@H](O)[C@H]1O
  CC(=O)O[C@@H]1[C@@H](O)[C@H](O)[C@@H](O)[C@H](OC(C)=O)[C@H]1O
  CC(=O)O[C@@H]1[C@@H](O)[C@H](O)[C@@H](OC(C)=O)[C@H](O)[C@H]1O
  CC(=O)O[C@H]1[C@H](OC(C)=O)[C@@H](O)[C@H](O)[C@@H](O)[C@@H]1O
Test 4
  NCC1OC1C(=O)NCC1OC1C(=O)NCC1OC1C(=O)NCC1OC1C(O)=O
  NCC1OC1C(=O)NCC1OC1C(=O)NCC1OC1C(O)=O
  NCC1OC1C(=O)NCC1OC1C(O)=O
Test 5
  CC(=O)O[C@@H]1O[C@H](CO)[C@@H](O)[C@H](O)[C@H]1O
  CC(=O)O[C@@H]1[C@@H](CO)O[C@@H](O)[C@H](O)[C@H]1O
  CC(=O)O[C@@H]1[C@@H](O)[C@H](O)O[C@H](CO)[C@H]1O
  CC(=O)O[C@@H]1[C@@H](O)[C@H](O)[C@@H](CO)O[C@H]1O
Test 6
  C[C@@H](Cl)N(C)S
  C[C@@H](Cl)[N@@](C)S |&1:1,&2:3|
  C[C@@H](Cl)[N@@](C)S |&1:1,o1:3|
  C[C@H](Cl)N(C)S
Test 7
  C[N@@](S)/C=C/[C@H](O)Cl
  C[N@](S)/C=C/[C@H](O)Cl
  N/C=C/O
  N/C=C\O
Test 8
  NCC(=O)NCC(=O)NCCCC[C@@H](N)C(O)=O |&1:13|
  NCC(=O)NCCCC[C@@H](N)C(O)=O |&1:9|
  NCC(=O)NCCCC[C@@H](NC(=O)CN)C(O)=O |&1:9|
  NCCCC[C@@H](NC(=O)CN)C(O)=O |&1:5|
Test 9
  N[C@H]1CCC[C@H]1C(=O)N(C(C1C=CC(=CC=1)[N+]([O-])=O)C(=O)NC1CCCCC1)[C@H]1CCC[C@H]1C(=O)N(C(C1C=CC(=CC=1)[N+]([O-])=O)C(=O)NC1CCCCC1)[C@H]1CCC[C@H]1C(=O)N(C(C1C=CC(=CC=1)[N+]([O-])=O)C(=O)NC1CCCCC1)[C@H]1CCC[C@H]1C(O)=O
  N[C@H]1CCC[C@H]1C(=O)N(C(C1C=CC(=CC=1)[N+]([O-])=O)C(=O)NC1CCCCC1)[C@H]1CCC[C@H]1C(=O)N(C(C1C=CC(=CC=1)[N+]([O-])=O)C(=O)NC1CCCCC1)[C@H]1CCC[C@H]1C(O)=O
  N[C@H]1CCC[C@H]1C(=O)N(C(C1C=CC(=CC=1)[N+]([O-])=O)C(=O)NC1CCCCC1)[C@H]1CCC[C@H]1C(O)=O
  N[C@H]1CCC[C@H]1C(O)(C(=O)NC1CCCCC1)N([C@H]1CCC[C@H]1C(O)=O)C(=O)[C@@H]1CCC[C@@H]1N(C(C1C=CC(=CC=1)[N+]([O-])=O)C(=O)NC1CCCCC1)C(=O)[C@@H]1CCC[C@@H]1N

*** Test set ***
('rpe-multistep-reactions', '1')
('rpe-mode', 'grid')
('rpe-self-reaction', '0')
('rpe-max-depth', '3')
('rpe-max-products-count', '10')
Test 1
  CC=CC(=O)NC1CCCC1
  CC=CC(=O)NCC
  CC=CC(=O)N[C@@H](C)CC
  CCNC(=O)C=CC(=O)NCC
  CCNC(=O)C=CC(O)=O
  C[C@@H](C(=O)NCC)C1C=CC=CC=1 |&1:1|
  C[C@@H](C(=O)N[C@@H](C)CC)C1C=CC=CC=1 |&1:1,a:5|
  C[C@@H](C1=CC=CC=C1)C(=O)NC1CCCC1 |&1:1|
  C[C@@H](CC)NC(=O)C=CC(O)=O
  OC(=O)C=CC(=O)NC1CCCC1
Test 1_aam
  C/C=C/C(=O)NC1CCCC1
  C/C=C/C(=O)NCC
  C/C=C/C(=O)N[C@@H](C)CC
  CCNC(=O)/C=C\C(=O)NCC
  CCNC(=O)/C=C\C(O)=O
  C[C@@H](C(=O)NCC)C1C=CC=CC=1 |&1:1|
  C[C@@H](C(=O)N[C@@H](C)CC)C1C=CC=CC=1 |&1:1,a:5|
  C[C@@H](C1=CC=CC=C1)C(=O)NC1CCCC1 |&1:1|
  C[C@@H](CC)NC(=O)/C=C\C(O)=O
  OC(=O)/C=C\C(=O)NC1CCCC1
Test 2
  CC1C=CC[C@@H]2[C@H]1C(=O)C=CC2=O |&1:5,6|
  CC1C=CC[C@@H]2[C@H]1C(=O)OC2=O |&1:5,6|
  C[C@@H]1CC=CC[C@]1(C)C=O |&1:1,6|
  C[C@@]1(CC=CC[C@]1(C)F)C=O |&1:1,6|
  O=C1C=CC(=O)[C@@H]2CC=CC[C@H]12 |&1:6,11|
  O=C1CC[C@@H]2CC=CC[C@H]12 |&1:4,9|
  O=C1OC(=O)[C@@H]2CC=CC[C@H]12 |&1:5,10|
  O=C1[C@@H]2CC=CC[C@@H]2C(=O)C2C=CC=CC1=2 |&1:2,7|
  O=C1[C@@H]2CC=CC[C@@H]2C(=O)[C@@H]2CC=CC[C@H]12 |&1:2,7,10,15|
  O=C1[C@@H]2CC=CC[C@@H]2C(=O)[C@H]2CC=CC[C@@H]12 |&1:2,7,10,15|
Test 3
  CC(=O)O[C@@H]1[C@@H](O)[C@H](O)[C@@H](O)[C@H](O)[C@H]1O
  CC(=O)O[C@@H]1[C@@H](O)[C@H](O)[C@@H](O)[C@H](OC(C)=O)[C@H]1O
  CC(=O)O[C@@H]1[C@@H](O)[C@H](O)[C@@H](OC(C)=O)[C@H](O)[C@H]1O
  CC(=O)O[C@@H]1[C@@H](O)[C@H](O)[C@@H](OC(C)=O)[C@H](OC(C)=O)[C@H]1O
  CC(=O)O[C@@H]1[C@@H](O)[C@H](OC(C)=O)[C@@H](O)[C@H](OC(C)=O)[C@H]1O
  CC(=O)O[C@@H]1[C@@H](OC(C)=O)[C@H](O)[C@@H](O)[C@H](O)[C@H]1O
  CC(=O)O[C@@H]1[C@@H](OC(C)=O)[C@H](O)[C@@H](O)[C@H](O)[C@H]1OC(C)=O
  CC(=O)O[C@H]1[C@H](O)[C@@H](O)[C@H](OC(C)=O)[C@@H](OC(C)=O)[C@@H]1O
  CC(=O)O[C@H]1[C@H](OC(C)=O)[C@@H](O)[C@H](O)[C@@H](O)[C@@H]1O
  O[C@H]1[C@H](O)[C@@H](O)[C@H](OC(=O)C2CCCCC2)[C@@H](O)[C@@H]1O
Test 4
  NCC1OC1C(=O)NCC1OC1C(=O)NCC1OC1C(=O)NCC1OC1C(O)=O
  NCC1OC1C(=O)NCC1OC1C(=O)NCC1OC1C(O)=O
  NCC1OC1C(=O)NCC1OC1C(O)=O
Test 5
  CC(=O)OC[C@H]1O[C@@H](O)[C@H](O)[C@@H](O)[C@@H]1O
  CC(=O)O[C@@H]1O[C@H](CO)[C@@H](O)[C@H](O)[C@H]1O
  CC(=O)O[C@@H]1O[C@H](CO)[C@@H](O)[C@H](OC(C)=O)[C@H]1O
  CC(=O)O[C@@H]1O[C@H](CO)[C@@H](OC(C)=O)[C@H](O)[C@H]1O
  CC(=O)O[C@@H]1[C@@H](CO)O[C@@H](O)[C@H](O)[C@H]1O
  CC(=O)O[C@@H]1[C@@H](O)[C@H](O)O[C@H](CO)[C@H]1O
  CC(=O)O[C@@H]1[C@@H](O)[C@H](O)O[C@H](COC(C)=O)[C@H]1O
  CC(=O)O[C@@H]1[C@@H](O)[C@H](O)[C@@H](CO)O[C@H]1O
  CC(=O)O[C@@H]1[C@@H](OC(C)=O)[C@H](O)O[C@H](CO)[C@H]1O
  CC(=O)O[C@H]1[C@H](OC(C)=O)[C@@H](CO)O[C@@H](O)[C@@H]1O
Test 6
  C[C@@H](Cl)N(C)S
  C[C@@H](Cl)[N@@](C)S |&1:1,&2:3|
  C[C@@H](Cl)[N@@](C)S |&1:1,o1:3|
  C[C@H](Cl)N(C)S
Test 7
  C[N@@](S)/C=C/[C@H](O)Cl
  C[N@](S)/C=C/[C@H](O)Cl
  N/C=C/O
  N/C=C\O
Test 8
  NCC(=O)NCC(=O)NCC(=O)NCCCC[C@@H](N)C(O)=O |&1:17|
  NCC(=O)NCC(=O)NCCCC[C@@H](N)C(O)=O |&1:13|
  NCC(=O)NCC(=O)NCCCC[C@@H](NC(=O)CN)C(O)=O |&1:13|
  NCC(=O)NCC(=O)N[C@@H](CCCCN)C(O)=O |&1:9|
  NCC(=O)NCCCC[C@@H](N)C(O)=O |&1:9|
  NCC(=O)NCCCC[C@@H](NC(=O)CN)C(O)=O |&1:9|
  NCC(=O)NCCCC[C@@H](NC(=O)CNC(=O)CN)C(O)=O |&1:9|
  NCCCC[C@@H](N)C(=O)NCC(O)=O |&1:5|
  NCCCC[C@@H](NC(=O)CN)C(O)=O |&1:5|
  NCCCC[C@@H](NC(=O)CNC(=O)CNC(=O)CN)C(O)=O |&1:5|
Test 9
  N[C@H]1CCC[C@H]1C(=O)N(C(C1C=CC(=CC=1)[N+]([O-])=O)C(=O)NC1CCCCC1)[C@H]1CCC[C@H]1C(=O)N(C(C1C=CC(=CC=1)[N+]([O-])=O)C(=O)NC1CCCCC1)[C@H]1CCC[C@H]1C(=O)N(C(C1C=CC(=CC=1)[N+]([O-])=O)C(=O)NC1CCCCC1)[C@H]1CCC[C@H]1C(O)=O
  N[C@H]1CCC[C@H]1C(=O)N(C(C1C=CC(=CC=1)[N+]([O-])=O)C(=O)NC1CCCCC1)[C@H]1CCC[C@H]1C(=O)N(C(C1C=CC(=CC=1)[N+]([O-])=O)C(=O)NC1CCCCC1)[C@H]1CCC[C@H]1C(O)=O
  N[C@H]1CCC[C@H]1C(=O)N(C(C1C=CC(=CC=1)[N+]([O-])=O)C(=O)NC1CCCCC1)[C@H]1CCC[C@H]1C(=O)N([C@H]1CCC[C@H]1C(=O)N(C(C1C=CC(=CC=1)[N+]([O-])=O)C(=O)NC1CCCCC1)[C@H]1CCC[C@H]1C(O)=O)C(O)([C@@H]1CCC[C@@H]1N)C(=O)NC1CCCCC1
  N[C@H]1CCC[C@H]1C(=O)N(C(C1C=CC(=CC=1)[N+]([O-])=O)C(=O)NC1CCCCC1)[C@H]1CCC[C@H]1C(O)=O
  N[C@H]1CCC[C@H]1C(=O)N([C@H]1CCC[C@H]1C(=O)N(C(C1C=CC(=CC=1)[N+]([O-])=O)C(=O)NC1CCCCC1)[C@H]1CCC[C@H]1C(O)=O)C(O)([C@@H]1CCC[C@@H]1N)C(=O)NC1CCCCC1
  N[C@H]1CCC[C@H]1C(=O)N([C@H]1CCC[C@H]1C(O)(C(=O)NC1CCCCC1)N([C@H]1CCC[C@H]1C(O)=O)C(=O)[C@@H]1CCC[C@@H]1N(C(C1C=CC(=CC=1)[N+]([O-])=O)C(=O)NC1CCCCC1)C(=O)[C@@H]1CCC[C@@H]1N)C(O)([C@@H]1CCC[C@@H]1N)C(=O)NC1CCCCC1
  N[C@H]1CCC[C@H]1C(O)(C(=O)NC1CCCCC1)N([C@H]1CCC[C@H]1C(=O)N(C(C1C=CC(=CC=1)[N+]([O-])=O)C(=O)NC1CCCCC1)[C@H]1CCC[C@H]1C(=O)N(C(C1C=CC(=CC=1)[N+]([O-])=O)C(=O)NC1CCCCC1)[C@H]1CCC[C@H]1C(O)=O)C(=O)[C@@H]1CCC[C@@H]1N
  N[C@H]1CCC[C@H]1C(O)(C(=O)NC1CCCCC1)N([C@H]1CCC[C@H]1C(=O)N([C@H]1CCC[C@H]1C(O)=O)C(O)([C@@H]1CCC[C@@H]1N)C(=O)NC1CCCCC1)C(=O)[C@@H]1CCC[C@@H]1N(C(C1C=CC(=CC=1)[N+]([O-])=O)C(=O)NC1CCCCC1)C(=O)[C@@H]1CCC[C@@H]1N
  N[C@H]1CCC[C@H]1C(O)(C(=O)NC1CCCCC1)N([C@H]1CCC[C@H]1C(O)=O)C(=O)[C@@H]1CCC[C@@H]1N(C(C1C=CC(=CC=1)[N+]([O-])=O)C(=O)NC1CCCCC1)C(=O)[C@@H]1CCC[C@@H]1N
  N[C@H]1CCC[C@H]1C(O)(C(=O)NC1CCCCC1)N([C@H]1CCC[C@H]1C(O)=O)C(=O)[C@@H]1CCC[C@@H]1N(C(C1C=CC(=CC=1)[N+]([O-])=O)C(=O)NC1CCCCC1)C(=O)[C@@H]1CCC[C@@H]1N(C(C1C=CC(=CC=1)[N+]([O-])=O)C(=O)NC1CCCCC1)C(=O)[C@@H]1CCC[C@@H]1N

*** Test set ***
('rpe-multistep-reactions', '1')
('rpe-mode', 'grid')
('rpe-self-reaction', '1')
('rpe-max-depth', '1')
('rpe-max-products-count', '4')
Test 1
  CC=CC(=O)NC1CCCC1
  CC=CC(=O)NCC
  CC=CC(=O)N[C@@H](C)CC
  CCNC(=O)C=CC(O)=O
Test 1_aam
  C/C=C/C(=O)NC1CCCC1
  C/C=C/C(=O)NCC
  C/C=C/C(=O)N[C@@H](C)CC
  CCNC(=O)/C=C\C(O)=O
Test 2
  O=C1C=CC(=O)[C@@H]2CC=CC[C@H]12 |&1:6,11|
  O=C1CC[C@@H]2CC=CC[C@H]12 |&1:4,9|
  O=C1OC(=O)[C@@H]2CC=CC[C@H]12 |&1:5,10|
  O=C1[C@@H]2CC=CC[C@@H]2C(=O)C2C=CC=CC1=2 |&1:2,7|
Test 3
  CC(=O)O[C@@H]1[C@@H](O)[C@H](O)[C@@H](O)[C@H](O)[C@H]1O
  O[C@H]1[C@H](O)[C@@H](O)[C@H](OC(=O)C2CCCCC2)[C@@H](O)[C@@H]1O
Test 4
  NCC1OC1C(=O)NCC1OC1C(O)=O
Test 5
  CC(=O)O[C@@H]1O[C@H](CO)[C@@H](O)[C@H](O)[C@H]1O
  CC(=O)O[C@@H]1[C@@H](CO)O[C@@H](O)[C@H](O)[C@H]1O
  CC(=O)O[C@@H]1[C@@H](O)[C@H](O)O[C@H](CO)[C@H]1O
  CC(=O)O[C@@H]1[C@@H](O)[C@H](O)[C@@H](CO)O[C@H]1O
Test 6
  C[C@@H](Cl)N(C)S
  C[C@@H](Cl)[N@@](C)S |&1:1,&2:3|
  C[C@@H](Cl)[N@@](C)S |&1:1,o1:3|
  C[C@H](Cl)N(C)S
Test 7
  C[N@@](S)/C=C/[C@H](O)Cl
  N/C=C/O
  N/C=C\O
Test 8
  NCC(=O)NCCCC[C@@H](N)C(O)=O |&1:9|
  NCCCC[C@@H](N)C(=O)NCC(O)=O |&1:5|
  NCCCC[C@@H](NC(=O)CN)C(O)=O |&1:5|
Test 9
  N[C@H]1CCC[C@H]1C(=O)N(C(C1C=CC(=CC=1)[N+]([O-])=O)C(=O)NC1CCCCC1)[C@H]1CCC[C@H]1C(O)=O

*** Test set ***
('rpe-multistep-reactions', '1')
('rpe-mode', 'grid')
('rpe-self-reaction', '1')
('rpe-max-depth', '1')
('rpe-max-products-count', '10')
Test 1
  CC=CC(=O)NC1CCCC1
  CC=CC(=O)NCC
  CC=CC(=O)N[C@@H](C)CC
  CCNC(=O)C=CC(O)=O
  C[C@@H](C(=O)NCC)C1C=CC=CC=1 |&1:1|
  C[C@@H](C(=O)N[C@@H](C)CC)C1C=CC=CC=1 |&1:1,a:5|
  C[C@@H](C1=CC=CC=C1)C(=O)NC1CCCC1 |&1:1|
  C[C@@H](CC)NC(=O)C=CC(O)=O
  OC(=O)C=CC(=O)NC1CCCC1
Test 1_aam
  C/C=C/C(=O)NC1CCCC1
  C/C=C/C(=O)NCC
  C/C=C/C(=O)N[C@@H](C)CC
  CCNC(=O)/C=C\C(O)=O
  C[C@@H](C(=O)NCC)C1C=CC=CC=1 |&1:1|
  C[C@@H](C(=O)N[C@@H](C)CC)C1C=CC=CC=1 |&1:1,a:5|
  C[C@@H](C1=CC=CC=C1)C(=O)NC1CCCC1 |&1:1|
  C[C@@H](CC)NC(=O)/C=C\C(O)=O
  OC(=O)/C=C\C(=O)NC1CCCC1
Test 2
  CC1C=CC[C@@H]2[C@H]1C(=O)C1C=CC=CC=1C2=O |&1:5,6|
  CC1C=CC[C@@H]2[C@H]1C(=O)C=CC2=O |&1:5,6|
  CC1C=CC[C@@H]2[C@H]1C(=O)OC2=O |&1:5,6|
  CC1C=CC[C@@H]2[C@H]1CCC2=O |&1:5,6|
  C[C@@H]1CC=CC[C@]1(C)C=O |&1:1,6|
  C[C@@]1(CC=CC[C@]1(C)F)C=O |&1:1,6|
  O=C1C=CC(=O)[C@@H]2CC=CC[C@H]12 |&1:6,11|
  O=C1CC[C@@H]2CC=CC[C@H]12 |&1:4,9|
  O=C1OC(=O)[C@@H]2CC=CC[C@H]12 |&1:5,10|
  O=C1[C@@H]2CC=CC[C@@H]2C(=O)C2C=CC=CC1=2 |&1:2,7|
Test 3
  CC(=O)O[C@@H]1[C@@H](O)[C@H](O)[C@@H](O)[C@H](O)[C@H]1O
  O[C@H]1[C@H](O)[C@@H](O)[C@H](OC(=O)C2CCCCC2)[C@@H](O)[C@@H]1O
Test 4
  NCC1OC1C(=O)NCC1OC1C(O)=O
Test 5
  CC(=O)OC[C@H]1O[C@@H](O)[C@H](O)[C@@H](O)[C@@H]1O
  CC(=O)O[C@@H]1O[C@H](CO)[C@@H](O)[C@H](O)[C@H]1O
  CC(=O)O[C@@H]1[C@@H](CO)O[C@@H](O)[C@H](O)[C@H]1O
  CC(=O)O[C@@H]1[C@@H](O)[C@H](O)O[C@H](CO)[C@H]1O
  CC(=O)O[C@@H]1[C@@H](O)[C@H](O)[C@@H](CO)O[C@H]1O
Test 6
  C[C@@H](Cl)N(C)S
  C[C@@H](Cl)[N@@](C)S |&1:1,&2:3|
  C[C@@H](Cl)[N@@](C)S |&1:1,o1:3|
  C[C@H](Cl)N(C)S
Test 7
  C[N@@](S)/C=C/[C@H](O)Cl
  N/C=C/O
  N/C=C\O
Test 8
  NCC(=O)NCCCC[C@@H](N)C(O)=O |&1:9|
  NCCCC[C@@H](N)C(=O)NCC(O)=O |&1:5|
  NCCCC[C@@H](NC(=O)CN)C(O)=O |&1:5|
Test 9
  N[C@H]1CCC[C@H]1C(=O)N(C(C1C=CC(=CC=1)[N+]([O-])=O)C(=O)NC1CCCCC1)[C@H]1CCC[C@H]1C(O)=O

*** Test set ***
('rpe-multistep-reactions', '1')
('rpe-mode', 'grid')
('rpe-self-reaction', '1')
('rpe-max-depth', '3')
('rpe-max-products-count', '4')
Test 1
  CC=CC(=O)NC1CCCC1
  CC=CC(=O)NCC
  CC=CC(=O)N[C@@H](C)CC
  CCNC(=O)C=CC(O)=O
Test 1_aam
  C/C=C/C(=O)NC1CCCC1
  C/C=C/C(=O)NCC
  C/C=C/C(=O)N[C@@H](C)CC
  CCNC(=O)/C=C\C(O)=O
Test 2
  O=C1C=CC(=O)[C@@H]2CC=CC[C@H]12 |&1:6,11|
  O=C1CC[C@@H]2CC=CC[C@H]12 |&1:4,9|
  O=C1OC(=O)[C@@H]2CC=CC[C@H]12 |&1:5,10|
  O=C1[C@@H]2CC=CC[C@@H]2C(=O)C2C=CC=CC1=2 |&1:2,7|
Test 3
  CC(=O)O[C@@H]1[C@@H](O)[C@H](O)[C@@H](O)[C@H](O)[C@H]1O
  CC(=O)O[C@@H]1[C@@H](O)[C@H](O)[C@@H](O)[C@H](OC(C)=O)[C@H]1O
  CC(=O)O[C@@H]1[C@@H](O)[C@H](O)[C@@H](OC(C)=O)[C@H](O)[C@H]1O
  CC(=O)O[C@H]1[C@H](OC(C)=O)[C@@H](O)[C@H](O)[C@@H](O)[C@@H]1O
Test 4
  NCC1OC1C(=O)NCC1OC1C(=O)NCC1OC1C(=O)NCC1OC1C(O)=O
  NCC1OC1C(=O)NCC1OC1C(=O)NCC1OC1C(O)=O
  NCC1OC1C(=O)NCC1OC1C(O)=O
Test 5
  CC(=O)O[C@@H]1O[C@H](CO)[C@@H](O)[C@H](O)[C@H]1O
  CC(=O)O[C@@H]1[C@@H](CO)O[C@@H](O)[C@H](O)[C@H]1O
  CC(=O)O[C@@H]1[C@@H](O)[C@H](O)O[C@H](CO)[C@H]1O
  CC(=O)O[C@@H]1[C@@H](O)[C@H](O)[C@@H](CO)O[C@H]1O
Test 6
  C[C@@H](Cl)N(C)S
  C[C@@H](Cl)[N@@](C)S |&1:1,&2:3|
  C[C@@H](Cl)[N@@](C)S |&1:1,o1:3|
  C[C@H](Cl)N(C)S
Test 7
  C[N@@](S)/C=C/[C@H](O)Cl
  C[N@](S)/C=C/[C@H](O)Cl
  N/C=C/O
  N/C=C\O
Test 8
  NCC(=O)NCC(=O)NCCCC[C@@H](N)C(O)=O |&1:13|
  NCC(=O)NCCCC[C@@H](N)C(O)=O |&1:9|
  NCC(=O)NCCCC[C@@H](NC(=O)CN)C(O)=O |&1:9|
  NCCCC[C@@H](NC(=O)CN)C(O)=O |&1:5|
Test 9
  N[C@H]1CCC[C@H]1C(=O)N(C(C1C=CC(=CC=1)[N+]([O-])=O)C(=O)NC1CCCCC1)[C@H]1CCC[C@H]1C(=O)N(C(C1C=CC(=CC=1)[N+]([O-])=O)C(=O)NC1CCCCC1)[C@H]1CCC[C@H]1C(=O)N(C(C1C=CC(=CC=1)[N+]([O-])=O)C(=O)NC1CCCCC1)[C@H]1CCC[C@H]1C(O)=O
  N[C@H]1CCC[C@H]1C(=O)N(C(C1C=CC(=CC=1)[N+]([O-])=O)C(=O)NC1CCCCC1)[C@H]1CCC[C@H]1C(=O)N(C(C1C=CC(=CC=1)[N+]([O-])=O)C(=O)NC1CCCCC1)[C@H]1CCC[C@H]1C(O)=O
  N[C@H]1CCC[C@H]1C(=O)N(C(C1C=CC(=CC=1)[N+]([O-])=O)C(=O)NC1CCCCC1)[C@H]1CCC[C@H]1C(O)=O
  N[C@H]1CCC[C@H]1C(O)(C(=O)NC1CCCCC1)N([C@H]1CCC[C@H]1C(O)=O)C(=O)[C@@H]1CCC[C@@H]1N(C(C1C=CC(=CC=1)[N+]([O-])=O)C(=O)NC1CCCCC1)C(=O)[C@@H]1CCC[C@@H]1N

*** Test set ***
('rpe-multistep-reactions', '1')
('rpe-mode', 'grid')
('rpe-self-reaction', '1')
('rpe-max-depth', '3')
('rpe-max-products-count', '10')
Test 1
  CC=CC(=O)NC1CCCC1
  CC=CC(=O)NCC
  CC=CC(=O)N[C@@H](C)CC
  CCNC(=O)C=CC(=O)NCC
  CCNC(=O)C=CC(O)=O
  C[C@@H](C(=O)NCC)C1C=CC=CC=1 |&1:1|
  C[C@@H](C(=O)N[C@@H](C)CC)C1C=CC=CC=1 |&1:1,a:5|
  C[C@@H](C1=CC=CC=C1)C(=O)NC1CCCC1 |&1:1|
  C[C@@H](CC)NC(=O)C=CC(O)=O
  OC(=O)C=CC(=O)NC1CCCC1
Test 1_aam
  C/C=C/C(=O)NC1CCCC1
  C/C=C/C(=O)NCC
  C/C=C/C(=O)N[C@@H](C)CC
  CCNC(=O)/C=C\C(=O)NCC
  CCNC(=O)/C=C\C(O)=O
  C[C@@H](C(=O)NCC)C1C=CC=CC=1 |&1:1|
  C[C@@H](C(=O)N[C@@H](C)CC)C1C=CC=CC=1 |&1:1,a:5|
  C[C@@H](C1=CC=CC=C1)C(=O)NC1CCCC1 |&1:1|
  C[C@@H](CC)NC(=O)/C=C\C(O)=O
  OC(=O)/C=C\C(=O)NC1CCCC1
Test 2
  CC1C=CC[C@@H]2[C@H]1C(=O)C=CC2=O |&1:5,6|
  CC1C=CC[C@@H]2[C@H]1C(=O)OC2=O |&1:5,6|
  C[C@@H]1CC=CC[C@]1(C)C=O |&1:1,6|
  C[C@@]1(CC=CC[C@]1(C)F)C=O |&1:1,6|
  O=C1C=CC(=O)[C@@H]2CC=CC[C@H]12 |&1:6,11|
  O=C1CC[C@@H]2CC=CC[C@H]12 |&1:4,9|
  O=C1OC(=O)[C@@H]2CC=CC[C@H]12 |&1:5,10|
  O=C1[C@@H]2CC=CC[C@@H]2C(=O)C2C=CC=CC1=2 |&1:2,7|
  O=C1[C@@H]2CC=CC[C@@H]2C(=O)[C@@H]2CC=CC[C@H]12 |&1:2,7,10,15|
  O=C1[C@@H]2CC=CC[C@@H]2C(=O)[C@H]2CC=CC[C@@H]12 |&1:2,7,10,15|
Test 3
  CC(=O)O[C@@H]1[C@@H](O)[C@H](O)[C@@H](O)[C@H](O)[C@H]1O
  CC(=O)O[C@@H]1[C@@H](O)[C@H](O)[C@@H](O)[C@H](OC(C)=O)[C@H]1O
  CC(=O)O[C@@H]1[C@@H](O)[C@H](O)[C@@H](OC(C)=O)[C@H](O)[C@H]1O
  CC(=O)O[C@@H]1[C@@H](O)[C@H](O)[C@@H](OC(C)=O)[C@H](OC(C)=O)[C@H]1O
  CC(=O)O[C@@H]1[C@@H](O)[C@H](OC(C)=O)[C@@H](O)[C@H](OC(C)=O)[C@H]1O
  CC(=O)O[C@@H]1[C@@H](OC(C)=O)[C@H](O)[C@@H](O)[C@H](O)[C@H]1O
  CC(=O)O[C@@H]1[C@@H](OC(C)=O)[C@H](O)[C@@H](O)[C@H](O)[C@H]1OC(C)=O
  CC(=O)O[C@H]1[C@H](O)[C@@H](O)[C@H](OC(C)=O)[C@@H](OC(C)=O)[C@@H]1O
  CC(=O)O[C@H]1[C@H](OC(C)=O)[C@@H](O)[C@H](O)[C@@H](O)[C@@H]1O
  O[C@H]1[C@H](O)[C@@H](O)[C@H](OC(=O)C2CCCCC2)[C@@H](O)[C@@H]1O
Test 4
  NCC1OC1C(=O)NCC1OC1C(=O)NCC1OC1C(=O)NCC1OC1C(O)=O
  NCC1OC1C(=O)NCC1OC1C(=O)NCC1OC1C(O)=O
  NCC1OC1C(=O)NCC1OC1C(O)=O
Test 5
  CC(=O)OC[C@H]1O[C@@H](O)[C@H](O)[C@@H](O)[C@@H]1O
  CC(=O)O[C@@H]1O[C@H](CO)[C@@H](O)[C@H](O)[C@H]1O
  CC(=O)O[C@@H]1O[C@H](CO)[C@@H](O)[C@H](OC(C)=O)[C@H]1O
  CC(=O)O[C@@H]1O[C@H](CO)[C@@H](OC(C)=O)[C@H](O)[C@H]1O
  CC(=O)O[C@@H]1[C@@H](CO)O[C@@H](O)[C@H](O)[C@H]1O
  CC(=O)O[C@@H]1[C@@H](O)[C@H](O)O[C@H](CO)[C@H]1O
  CC(=O)O[C@@H]1[C@@H](O)[C@H](O)O[C@H](COC(C)=O)[C@H]1O
  CC(=O)O[C@@H]1[C@@H](O)[C@H](O)[C@@H](CO)O[C@H]1O
  CC(=O)O[C@@H]1[C@@H](OC(C)=O)[C@H](O)O[C@H](CO)[C@H]1O
  CC(=O)O[C@H]1[C@H](OC(C)=O)[C@@H](CO)O[C@@H](O)[C@@H]1O
Test 6
  C[C@@H](Cl)N(C)S
  C[C@@H](Cl)[N@@](C)S |&1:1,&2:3|
  C[C@@H](Cl)[N@@](C)S |&1:1,o1:3|
  C[C@H](Cl)N(C)S
Test 7
  C[N@@](S)/C=C/[C@H](O)Cl
  C[N@](S)/C=C/[C@H](O)Cl
  N/C=C/O
  N/C=C\O
Test 8
  NCC(=O)NCC(=O)NCC(=O)NCCCC[C@@H](N)C(O)=O |&1:17|
  NCC(=O)NCC(=O)NCCCC[C@@H](N)C(O)=O |&1:13|
  NCC(=O)NCC(=O)NCCCC[C@@H](NC(=O)CN)C(O)=O |&1:13|
  NCC(=O)NCC(=O)N[C@@H](CCCCN)C(O)=O |&1:9|
  NCC(=O)NCCCC[C@@H](N)C(O)=O |&1:9|
  NCC(=O)NCCCC[C@@H](NC(=O)CN)C(O)=O |&1:9|
  NCC(=O)NCCCC[C@@H](NC(=O)CNC(=O)CN)C(O)=O |&1:9|
  NCCCC[C@@H](N)C(=O)NCC(O)=O |&1:5|
  NCCCC[C@@H](NC(=O)CN)C(O)=O |&1:5|
  NCCCC[C@@H](NC(=O)CNC(=O)CNC(=O)CN)C(O)=O |&1:5|
Test 9
  N[C@H]1CCC[C@H]1C(=O)N(C(C1C=CC(=CC=1)[N+]([O-])=O)C(=O)NC1CCCCC1)[C@H]1CCC[C@H]1C(=O)N(C(C1C=CC(=CC=1)[N+]([O-])=O)C(=O)NC1CCCCC1)[C@H]1CCC[C@H]1C(=O)N(C(C1C=CC(=CC=1)[N+]([O-])=O)C(=O)NC1CCCCC1)[C@H]1CCC[C@H]1C(O)=O
  N[C@H]1CCC[C@H]1C(=O)N(C(C1C=CC(=CC=1)[N+]([O-])=O)C(=O)NC1CCCCC1)[C@H]1CCC[C@H]1C(=O)N(C(C1C=CC(=CC=1)[N+]([O-])=O)C(=O)NC1CCCCC1)[C@H]1CCC[C@H]1C(O)=O
  N[C@H]1CCC[C@H]1C(=O)N(C(C1C=CC(=CC=1)[N+]([O-])=O)C(=O)NC1CCCCC1)[C@H]1CCC[C@H]1C(=O)N([C@H]1CCC[C@H]1C(=O)N(C(C1C=CC(=CC=1)[N+]([O-])=O)C(=O)NC1CCCCC1)[C@H]1CCC[C@H]1C(O)=O)C(O)([C@@H]1CCC[C@@H]1N)C(=O)NC1CCCCC1
  N[C@H]1CCC[C@H]1C(=O)N(C(C1C=CC(=CC=1)[N+]([O-])=O)C(=O)NC1CCCCC1)[C@H]1CCC[C@H]1C(O)=O
  N[C@H]1CCC[C@H]1C(=O)N([C@H]1CCC[C@H]1C(=O)N(C(C1C=CC(=CC=1)[N+]([O-])=O)C(=O)NC1CCCCC1)[C@H]1CCC[C@H]1C(O)=O)C(O)([C@@H]1CCC[C@@H]1N)C(=O)NC1CCCCC1
  N[C@H]1CCC[C@H]1C(=O)N([C@H]1CCC[C@H]1C(O)(C(=O)NC1CCCCC1)N([C@H]1CCC[C@H]1C(O)=O)C(=O)[C@@H]1CCC[C@@H]1N(C(C1C=CC(=CC=1)[N+]([O-])=O)C(=O)NC1CCCCC1)C(=O)[C@@H]1CCC[C@@H]1N)C(O)([C@@H]1CCC[C@@H]1N)C(=O)NC1CCCCC1
  N[C@H]1CCC[C@H]1C(O)(C(=O)NC1CCCCC1)N([C@H]1CCC[C@H]1C(=O)N(C(C1C=CC(=CC=1)[N+]([O-])=O)C(=O)NC1CCCCC1)[C@H]1CCC[C@H]1C(=O)N(C(C1C=CC(=CC=1)[N+]([O-])=O)C(=O)NC1CCCCC1)[C@H]1CCC[C@H]1C(O)=O)C(=O)[C@@H]1CCC[C@@H]1N
  N[C@H]1CCC[C@H]1C(O)(C(=O)NC1CCCCC1)N([C@H]1CCC[C@H]1C(=O)N([C@H]1CCC[C@H]1C(O)=O)C(O)([C@@H]1CCC[C@@H]1N)C(=O)NC1CCCCC1)C(=O)[C@@H]1CCC[C@@H]1N(C(C1C=CC(=CC=1)[N+]([O-])=O)C(=O)NC1CCCCC1)C(=O)[C@@H]1CCC[C@@H]1N
  N[C@H]1CCC[C@H]1C(O)(C(=O)NC1CCCCC1)N([C@H]1CCC[C@H]1C(O)=O)C(=O)[C@@H]1CCC[C@@H]1N(C(C1C=CC(=CC=1)[N+]([O-])=O)C(=O)NC1CCCCC1)C(=O)[C@@H]1CCC[C@@H]1N
  N[C@H]1CCC[C@H]1C(O)(C(=O)NC1CCCCC1)N([C@H]1CCC[C@H]1C(O)=O)C(=O)[C@@H]1CCC[C@@H]1N(C(C1C=CC(=CC=1)[N+]([O-])=O)C(=O)NC1CCCCC1)C(=O)[C@@H]1CCC[C@@H]1N(C(C1C=CC(=CC=1)[N+]([O-])=O)C(=O)NC1CCCCC1)C(=O)[C@@H]1CCC[C@@H]1N

*** Test set ***
('rpe-multistep-reactions', '1')
('rpe-mode', 'one-tube')
('rpe-self-reaction', '0')
('rpe-max-depth', '1')
('rpe-max-products-count', '4')
Test 1
  CC=CC(=O)NC1CCCC1
  CC=CC(=O)NCC
  CC=CC(=O)N[C@@H](C)CC
  CCNC(=O)C=CC(O)=O
Test 1_aam
  C/C=C/C(=O)NC1CCCC1
  C/C=C/C(=O)NCC
  C/C=C/C(=O)N[C@@H](C)CC
  CCNC(=O)/C=C\C(O)=O
Test 2
  O=C1C=CC(=O)[C@@H]2CC=CC[C@H]12 |&1:6,11|
  O=C1CC[C@@H]2CC=CC[C@H]12 |&1:4,9|
  O=C1OC(=O)[C@@H]2CC=CC[C@H]12 |&1:5,10|
  O=C1[C@@H]2CC=CC[C@@H]2C(=O)C2C=CC=CC1=2 |&1:2,7|
Test 3
  CC(=O)O[C@@H]1[C@@H](O)[C@H](O)[C@@H](O)[C@H](O)[C@H]1O
  O[C@H]1[C@H](O)[C@@H](O)[C@H](OC(=O)C2CCCCC2)[C@@H](O)[C@@H]1O
Test 4
  NCC1OC1C(=O)NCC1OC1C(O)=O
Test 5
  CC(=O)O[C@@H]1O[C@H](CO)[C@@H](O)[C@H](O)[C@H]1O
  CC(=O)O[C@@H]1[C@@H](CO)O[C@@H](O)[C@H](O)[C@H]1O
  CC(=O)O[C@@H]1[C@@H](O)[C@H](O)O[C@H](CO)[C@H]1O
  CC(=O)O[C@@H]1[C@@H](O)[C@H](O)[C@@H](CO)O[C@H]1O
Test 6
  C[C@@H](Cl)N(C)S
  C[C@@H](Cl)[N@@](C)S |&1:1,&2:3|
  C[C@@H](Cl)[N@@](C)S |&1:1,o1:3|
  C[C@H](Cl)N(C)S
Test 7
  C[N@@](S)/C=C/[C@H](O)Cl
  N/C=C/O
  N/C=C\O
Test 8
  NCC(=O)NCC(O)=O
  NCC(=O)NCCCC[C@@H](N)C(O)=O |&1:9|
  NCCCC[C@@H](N)C(=O)NCC(O)=O |&1:5|
  NCCCC[C@@H](NC(=O)CN)C(O)=O |&1:5|
Test 9
  N[C@H]1CCC[C@H]1C(=O)N(C(C1C=CC(=CC=1)[N+]([O-])=O)C(=O)NC1CCCCC1)[C@H]1CCC[C@H]1C(O)=O
  N[C@H]1CCC[C@H]1C(O)(C(=O)NC1CCCCC1)N([C@H]1CCC[C@H]1C(O)=O)C(=O)[C@@H]1CCC[C@@H]1N

*** Test set ***
('rpe-multistep-reactions', '1')
('rpe-mode', 'one-tube')
('rpe-self-reaction', '0')
('rpe-max-depth', '1')
('rpe-max-products-count', '10')
Test 1
  CC=CC(=O)NC1CCCC1
  CC=CC(=O)NCC
  CC=CC(=O)N[C@@H](C)CC
  CCNC(=O)C=CC(O)=O
  C[C@@H](C(=O)NCC)C1C=CC=CC=1 |&1:1|
  C[C@@H](C(=O)N[C@@H](C)CC)C1C=CC=CC=1 |&1:1,a:5|
  C[C@@H](C1=CC=CC=C1)C(=O)NC1CCCC1 |&1:1|
  C[C@@H](CC)NC(=O)C=CC(O)=O
  OC(=O)C=CC(=O)NC1CCCC1
Test 1_aam
  C/C=C/C(=O)NC1CCCC1
  C/C=C/C(=O)NCC
  C/C=C/C(=O)N[C@@H](C)CC
  CCNC(=O)/C=C\C(O)=O
  C[C@@H](C(=O)NCC)C1C=CC=CC=1 |&1:1|
  C[C@@H](C(=O)N[C@@H](C)CC)C1C=CC=CC=1 |&1:1,a:5|
  C[C@@H](C1=CC=CC=C1)C(=O)NC1CCCC1 |&1:1|
  C[C@@H](CC)NC(=O)/C=C\C(O)=O
  OC(=O)/C=C\C(=O)NC1CCCC1
Test 2
  CC1C=CC[C@@H]2[C@H]1C(=O)C1C=CC=CC=1C2=O |&1:5,6|
  CC1C=CC[C@@H]2[C@H]1C(=O)C=CC2=O |&1:5,6|
  CC1C=CC[C@@H]2[C@H]1C(=O)OC2=O |&1:5,6|
  CC1C=CC[C@@H]2[C@H]1CCC2=O |&1:5,6|
  C[C@@H]1CC=CC[C@]1(C)C=O |&1:1,6|
  C[C@@]1(CC=CC[C@]1(C)F)C=O |&1:1,6|
  O=C1C=CC(=O)[C@@H]2CC=CC[C@H]12 |&1:6,11|
  O=C1CC[C@@H]2CC=CC[C@H]12 |&1:4,9|
  O=C1OC(=O)[C@@H]2CC=CC[C@H]12 |&1:5,10|
  O=C1[C@@H]2CC=CC[C@@H]2C(=O)C2C=CC=CC1=2 |&1:2,7|
Test 3
  CC(=O)O[C@@H]1[C@@H](O)[C@H](O)[C@@H](O)[C@H](O)[C@H]1O
  O[C@H]1[C@H](O)[C@@H](O)[C@H](OC(=O)C2CCCCC2)[C@@H](O)[C@@H]1O
Test 4
  NCC1OC1C(=O)NCC1OC1C(O)=O
Test 5
  CC(=O)OC[C@H]1O[C@@H](O)[C@H](O)[C@@H](O)[C@@H]1O
  CC(=O)O[C@@H]1O[C@H](CO)[C@@H](O)[C@H](O)[C@H]1O
  CC(=O)O[C@@H]1[C@@H](CO)O[C@@H](O)[C@H](O)[C@H]1O
  CC(=O)O[C@@H]1[C@@H](O)[C@H](O)O[C@H](CO)[C@H]1O
  CC(=O)O[C@@H]1[C@@H](O)[C@H](O)[C@@H](CO)O[C@H]1O
Test 6
  C[C@@H](Cl)N(C)S
  C[C@@H](Cl)[N@@](C)S |&1:1,&2:3|
  C[C@@H](Cl)[N@@](C)S |&1:1,o1:3|
  C[C@H](Cl)N(C)S
Test 7
  C[N@@](S)/C=C/[C@H](O)Cl
  N/C=C/O
  N/C=C\O
Test 8
  NCC(=O)NCC(O)=O
  NCC(=O)NCCCC[C@@H](N)C(O)=O |&1:9|
  NCCCC[C@@H](N)C(=O)NCC(O)=O |&1:5|
  NCCCC[C@@H](N)C(=O)NCCCC[C@@H](N)C(O)=O |&1:5,14|
  NCCCC[C@@H](NC(=O)CN)C(O)=O |&1:5|
  N[C@@H](CCCCN)C(=O)N[C@H](CCCCN)C(O)=O |&1:1,10|
Test 9
  N[C@H]1CCC[C@H]1C(=O)N(C(C1C=CC(=CC=1)[N+]([O-])=O)C(=O)NC1CCCCC1)[C@H]1CCC[C@H]1C(O)=O
  N[C@H]1CCC[C@H]1C(O)(C(=O)NC1CCCCC1)N([C@H]1CCC[C@H]1C(O)=O)C(=O)[C@@H]1CCC[C@@H]1N

*** Test set ***
('rpe-multistep-reactions', '1')
('rpe-mode', 'one-tube')
('rpe-self-reaction', '0')
('rpe-max-depth', '3')
('rpe-max-products-count', '4')
Test 1
  CC=CC(=O)NC1CCCC1
  CC=CC(=O)NCC
  CC=CC(=O)N[C@@H](C)CC
  CCNC(=O)C=CC(O)=O
Test 1_aam
  C/C=C/C(=O)NC1CCCC1
  C/C=C/C(=O)NCC
  C/C=C/C(=O)N[C@@H](C)CC
  CCNC(=O)/C=C\C(O)=O
Test 2
  O=C1C=CC(=O)[C@@H]2CC=CC[C@H]12 |&1:6,11|
  O=C1CC[C@@H]2CC=CC[C@H]12 |&1:4,9|
  O=C1OC(=O)[C@@H]2CC=CC[C@H]12 |&1:5,10|
  O=C1[C@@H]2CC=CC[C@@H]2C(=O)C2C=CC=CC1=2 |&1:2,7|
Test 3
  CC(=O)O[C@@H]1[C@@H](O)[C@H](O)[C@@H](O)[C@H](O)[C@H]1O
  CC(=O)O[C@@H]1[C@@H](O)[C@H](O)[C@@H](O)[C@H](OC(C)=O)[C@H]1O
  CC(=O)O[C@@H]1[C@@H](O)[C@H](O)[C@@H](OC(C)=O)[C@H](O)[C@H]1O
  CC(=O)O[C@H]1[C@H](OC(C)=O)[C@@H](O)[C@H](O)[C@@H](O)[C@@H]1O
Test 4
  NCC1OC1C(=O)NCC1OC1C(=O)NCC1OC1C(=O)NCC1OC1C(O)=O
  NCC1OC1C(=O)NCC1OC1C(=O)NCC1OC1C(O)=O
  NCC1OC1C(=O)NCC1OC1C(O)=O
Test 5
  CC(=O)O[C@@H]1O[C@H](CO)[C@@H](O)[C@H](O)[C@H]1O
  CC(=O)O[C@@H]1[C@@H](CO)O[C@@H](O)[C@H](O)[C@H]1O
  CC(=O)O[C@@H]1[C@@H](O)[C@H](O)O[C@H](CO)[C@H]1O
  CC(=O)O[C@@H]1[C@@H](O)[C@H](O)[C@@H](CO)O[C@H]1O
Test 6
  C[C@@H](Cl)N(C)S
  C[C@@H](Cl)[N@@](C)S |&1:1,&2:3|
  C[C@@H](Cl)[N@@](C)S |&1:1,o1:3|
  C[C@H](Cl)N(C)S
Test 7
  C[N@@](S)/C=C/[C@H](O)Cl
  C[N@](S)/C=C/[C@H](O)Cl
  N/C=C/O
  N/C=C\O
Test 8
  NCC(=O)NCC(=O)NCC(O)=O
  NCC(=O)NCC(O)=O
  NCC(=O)NCCCC[C@@H](N)C(O)=O |&1:9|
  NCCCC[C@@H](NC(=O)CN)C(O)=O |&1:5|
Test 9
  N[C@H]1CCC[C@H]1C(=O)N(C(C1C=CC(=CC=1)[N+]([O-])=O)C(=O)NC1CCCCC1)[C@H]1CCC[C@H]1C(=O)N(C(C1C=CC(=CC=1)[N+]([O-])=O)C(=O)NC1CCCCC1)[C@H]1CCC[C@H]1C(=O)N(C(C1C=CC(=CC=1)[N+]([O-])=O)C(=O)NC1CCCCC1)[C@H]1CCC[C@H]1C(O)=O
  N[C@H]1CCC[C@H]1C(=O)N(C(C1C=CC(=CC=1)[N+]([O-])=O)C(=O)NC1CCCCC1)[C@H]1CCC[C@H]1C(=O)N(C(C1C=CC(=CC=1)[N+]([O-])=O)C(=O)NC1CCCCC1)[C@H]1CCC[C@H]1C(O)=O
  N[C@H]1CCC[C@H]1C(=O)N(C(C1C=CC(=CC=1)[N+]([O-])=O)C(=O)NC1CCCCC1)[C@H]1CCC[C@H]1C(O)=O
  N[C@H]1CCC[C@H]1C(O)(C(=O)NC1CCCCC1)N([C@H]1CCC[C@H]1C(O)=O)C(=O)[C@@H]1CCC[C@@H]1N

*** Test set ***
('rpe-multistep-reactions', '1')
('rpe-mode', 'one-tube')
('rpe-self-reaction', '0')
('rpe-max-depth', '3')
('rpe-max-products-count', '10')
Test 1
  CC=CC(=O)NC1CCCC1
  CC=CC(=O)NCC
  CC=CC(=O)N[C@@H](C)CC
  CCNC(=O)C=CC(=O)NCC
  CCNC(=O)C=CC(O)=O
  C[C@@H](C(=O)NCC)C1C=CC=CC=1 |&1:1|
  C[C@@H](C(=O)N[C@@H](C)CC)C1C=CC=CC=1 |&1:1,a:5|
  C[C@@H](C1=CC=CC=C1)C(=O)NC1CCCC1 |&1:1|
  C[C@@H](CC)NC(=O)C=CC(O)=O
  OC(=O)C=CC(=O)NC1CCCC1
Test 1_aam
  C/C=C/C(=O)NC1CCCC1
  C/C=C/C(=O)NCC
  C/C=C/C(=O)N[C@@H](C)CC
  CCNC(=O)/C=C\C(=O)NCC
  CCNC(=O)/C=C\C(O)=O
  C[C@@H](C(=O)NCC)C1C=CC=CC=1 |&1:1|
  C[C@@H](C(=O)N[C@@H](C)CC)C1C=CC=CC=1 |&1:1,a:5|
  C[C@@H](C1=CC=CC=C1)C(=O)NC1CCCC1 |&1:1|
  C[C@@H](CC)NC(=O)/C=C\C(O)=O
  OC(=O)/C=C\C(=O)NC1CCCC1
Test 2
  CC1C=CC[C@@H]2[C@H]1C(=O)C=CC2=O |&1:5,6|
  CC1C=CC[C@@H]2[C@H]1C(=O)OC2=O |&1:5,6|
  C[C@@H]1CC=CC[C@]1(C)C=O |&1:1,6|
  C[C@@]1(CC=CC[C@]1(C)F)C=O |&1:1,6|
  O=C1C=CC(=O)[C@@H]2CC=CC[C@H]12 |&1:6,11|
  O=C1CC[C@@H]2CC=CC[C@H]12 |&1:4,9|
  O=C1OC(=O)[C@@H]2CC=CC[C@H]12 |&1:5,10|
  O=C1[C@@H]2CC=CC[C@@H]2C(=O)C2C=CC=CC1=2 |&1:2,7|
  O=C1[C@@H]2CC=CC[C@@H]2C(=O)[C@@H]2CC=CC[C@H]12 |&1:2,7,10,15|
  O=C1[C@@H]2CC=CC[C@@H]2C(=O)[C@H]2CC=CC[C@@H]12 |&1:2,7,10,15|
Test 3
  CC(=O)O[C@@H]1[C@@H](O)[C@H](O)[C@@H](O)[C@H](O)[C@H]1O
  CC(=O)O[C@@H]1[C@@H](O)[C@H](O)[C@@H](O)[C@H](OC(C)=O)[C@H]1O
  CC(=O)O[C@@H]1[C@@H](O)[C@H](O)[C@@H](OC(C)=O)[C@H](O)[C@H]1O
  CC(=O)O[C@@H]1[C@@H](O)[C@H](O)[C@@H](OC(C)=O)[C@H](OC(C)=O)[C@H]1O
  CC(=O)O[C@@H]1[C@@H](O)[C@H](OC(C)=O)[C@@H](O)[C@H](OC(C)=O)[C@H]1O
  CC(=O)O[C@@H]1[C@@H](OC(C)=O)[C@H](O)[C@@H](O)[C@H](O)[C@H]1O
  CC(=O)O[C@@H]1[C@@H](OC(C)=O)[C@H](O)[C@@H](O)[C@H](O)[C@H]1OC(C)=O
  CC(=O)O[C@H]1[C@H](O)[C@@H](O)[C@H](OC(C)=O)[C@@H](OC(C)=O)[C@@H]1O
  CC(=O)O[C@H]1[C@H](OC(C)=O)[C@@H](O)[C@H](O)[C@@H](O)[C@@H]1O
  O[C@H]1[C@H](O)[C@@H](O)[C@H](OC(=O)C2CCCCC2)[C@@H](O)[C@@H]1O
Test 4
  NCC1OC1C(=O)NCC1OC1C(=O)NCC1OC1C(=O)NCC1OC1C(O)=O
  NCC1OC1C(=O)NCC1OC1C(=O)NCC1OC1C(O)=O
  NCC1OC1C(=O)NCC1OC1C(O)=O
Test 5
  CC(=O)OC[C@H]1O[C@@H](O)[C@H](O)[C@@H](O)[C@@H]1O
  CC(=O)O[C@@H]1O[C@H](CO)[C@@H](O)[C@H](O)[C@H]1O
  CC(=O)O[C@@H]1O[C@H](CO)[C@@H](O)[C@H](OC(C)=O)[C@H]1O
  CC(=O)O[C@@H]1O[C@H](CO)[C@@H](OC(C)=O)[C@H](O)[C@H]1O
  CC(=O)O[C@@H]1[C@@H](CO)O[C@@H](O)[C@H](O)[C@H]1O
  CC(=O)O[C@@H]1[C@@H](O)[C@H](O)O[C@H](CO)[C@H]1O
  CC(=O)O[C@@H]1[C@@H](O)[C@H](O)O[C@H](COC(C)=O)[C@H]1O
  CC(=O)O[C@@H]1[C@@H](O)[C@H](O)[C@@H](CO)O[C@H]1O
  CC(=O)O[C@@H]1[C@@H](OC(C)=O)[C@H](O)O[C@H](CO)[C@H]1O
  CC(=O)O[C@H]1[C@H](OC(C)=O)[C@@H](CO)O[C@@H](O)[C@@H]1O
Test 6
  C[C@@H](Cl)N(C)S
  C[C@@H](Cl)[N@@](C)S |&1:1,&2:3|
  C[C@@H](Cl)[N@@](C)S |&1:1,o1:3|
  C[C@H](Cl)N(C)S
Test 7
  C[N@@](S)/C=C/[C@H](O)Cl
  C[N@](S)/C=C/[C@H](O)Cl
  N/C=C/O
  N/C=C\O
Test 8
  NCC(=O)NCC(=O)NCC(=O)NCC(O)=O
  NCC(=O)NCC(=O)NCC(=O)NCCCC[C@@H](N)C(O)=O |&1:17|
  NCC(=O)NCC(=O)NCC(O)=O
  NCC(=O)NCC(=O)NCCCC[C@@H](N)C(O)=O |&1:13|
  NCC(=O)NCC(=O)NCCCC[C@@H](NC(=O)CN)C(O)=O |&1:13|
  NCC(=O)NCC(=O)N[C@@H](CCCCN)C(O)=O |&1:9|
  NCC(=O)NCC(O)=O
  NCC(=O)NCCCC[C@@H](N)C(O)=O |&1:9|
  NCC(=O)NCCCC[C@@H](NC(=O)CN)C(O)=O |&1:9|
  NCCCC[C@@H](NC(=O)CN)C(O)=O |&1:5|
Test 9
  N[C@H]1CCC[C@H]1C(=O)N(C(C1C=CC(=CC=1)[N+]([O-])=O)C(=O)NC1CCCCC1)[C@H]1CCC[C@H]1C(=O)N(C(C1C=CC(=CC=1)[N+]([O-])=O)C(=O)NC1CCCCC1)[C@H]1CCC[C@H]1C(=O)N(C(C1C=CC(=CC=1)[N+]([O-])=O)C(=O)NC1CCCCC1)[C@H]1CCC[C@H]1C(O)=O
  N[C@H]1CCC[C@H]1C(=O)N(C(C1C=CC(=CC=1)[N+]([O-])=O)C(=O)NC1CCCCC1)[C@H]1CCC[C@H]1C(=O)N(C(C1C=CC(=CC=1)[N+]([O-])=O)C(=O)NC1CCCCC1)[C@H]1CCC[C@H]1C(O)=O
  N[C@H]1CCC[C@H]1C(=O)N(C(C1C=CC(=CC=1)[N+]([O-])=O)C(=O)NC1CCCCC1)[C@H]1CCC[C@H]1C(O)=O
  N[C@H]1CCC[C@H]1C(=O)N([C@H]1CCC[C@H]1C(=O)N(C(C1C=CC(=CC=1)[N+]([O-])=O)C(=O)NC1CCCCC1)[C@H]1CCC[C@H]1C(O)=O)C(O)([C@@H]1CCC[C@@H]1N)C(=O)NC1CCCCC1
  N[C@H]1CCC[C@H]1C(=O)N([C@H]1CCC[C@H]1C(=O)N([C@H]1CCC[C@H]1C(=O)N([C@H]1CCC[C@H]1C(O)=O)C(O)([C@@H]1CCC[C@@H]1N)C(=O)NC1CCCCC1)C(O)([C@@H]1CCC[C@@H]1N)C(=O)NC1CCCCC1)C(O)([C@@H]1CCC[C@@H]1N)C(=O)NC1CCCCC1
  N[C@H]1CCC[C@H]1C(O)(C(=O)NC1CCCCC1)N([C@H]1CCC[C@H]1C(=O)N([C@H]1CCC[C@H]1C(O)=O)C(O)([C@@H]1CCC[C@@H]1N)C(=O)NC1CCCCC1)C(=O)[C@@H]1CCC[C@@H]1N
  N[C@H]1CCC[C@H]1C(O)(C(=O)NC1CCCCC1)N([C@H]1CCC[C@H]1C(=O)N([C@H]1CCC[C@H]1C(O)=O)C(O)([C@@H]1CCC[C@@H]1N)C(=O)NC1CCCCC1)C(=O)[C@@H]1CCC[C@@H]1N(C(C1C=CC(=CC=1)[N+]([O-])=O)C(=O)NC1CCCCC1)C(=O)[C@@H]1CCC[C@@H]1N
  N[C@H]1CCC[C@H]1C(O)(C(=O)NC1CCCCC1)N([C@H]1CCC[C@H]1C(O)=O)C(=O)[C@@H]1CCC[C@@H]1N
  N[C@H]1CCC[C@H]1C(O)(C(=O)NC1CCCCC1)N([C@H]1CCC[C@H]1C(O)=O)C(=O)[C@@H]1CCC[C@@H]1N(C(C1C=CC(=CC=1)[N+]([O-])=O)C(=O)NC1CCCCC1)C(=O)[C@@H]1CCC[C@@H]1N
  N[C@H]1CCC[C@H]1C(O)(C(=O)NC1CCCCC1)N([C@H]1CCC[C@H]1C(O)=O)C(=O)[C@@H]1CCC[C@@H]1N(C(C1C=CC(=CC=1)[N+]([O-])=O)C(=O)NC1CCCCC1)C(=O)[C@@H]1CCC[C@@H]1N(C(C1C=CC(=CC=1)[N+]([O-])=O)C(=O)NC1CCCCC1)C(=O)[C@@H]1CCC[C@@H]1N

*** Test set ***
('rpe-multistep-reactions', '1')
('rpe-mode', 'one-tube')
('rpe-self-reaction', '1')
('rpe-max-depth', '1')
('rpe-max-products-count', '4')
Test 1
  CC=CC(=O)NC1CCCC1
  CC=CC(=O)NCC
  CC=CC(=O)N[C@@H](C)CC
  CCNC(=O)C=CC(O)=O
Test 1_aam
  C/C=C/C(=O)NC1CCCC1
  C/C=C/C(=O)NCC
  C/C=C/C(=O)N[C@@H](C)CC
  CCNC(=O)/C=C\C(O)=O
Test 2
  O=C1C=CC(=O)[C@@H]2CC=CC[C@H]12 |&1:6,11|
  O=C1CC[C@@H]2CC=CC[C@H]12 |&1:4,9|
  O=C1OC(=O)[C@@H]2CC=CC[C@H]12 |&1:5,10|
  O=C1[C@@H]2CC=CC[C@@H]2C(=O)C2C=CC=CC1=2 |&1:2,7|
Test 3
  CC(=O)O[C@@H]1[C@@H](O)[C@H](O)[C@@H](O)[C@H](O)[C@H]1O
  O[C@H]1[C@H](O)[C@@H](O)[C@H](OC(=O)C2CCCCC2)[C@@H](O)[C@@H]1O
Test 4
  NCC1OC1C(=O)NCC1OC1C(O)=O
  O=C1NCC2OC12
Test 5
  CC(=O)O[C@@H]1O[C@H](CO)[C@@H](O)[C@H](O)[C@H]1O
  CC(=O)O[C@@H]1[C@@H](CO)O[C@@H](O)[C@H](O)[C@H]1O
  CC(=O)O[C@@H]1[C@@H](O)[C@H](O)O[C@H](CO)[C@H]1O
  CC(=O)O[C@@H]1[C@@H](O)[C@H](O)[C@@H](CO)O[C@H]1O
Test 6
  C[C@@H](Cl)N(C)S
  C[C@@H](Cl)[N@@](C)S |&1:1,&2:3|
  C[C@@H](Cl)[N@@](C)S |&1:1,o1:3|
  C[C@H](Cl)N(C)S
Test 7
  C[N@@](S)/C=C/[C@H](O)Cl
  N/C=C/O
  N/C=C\O
Test 8
  NCC(=O)NCC(O)=O
  NCC(=O)NCCCC[C@@H](N)C(O)=O |&1:9|
  NCCCC[C@@H](N)C(=O)NCC(O)=O |&1:5|
  NCCCC[C@@H](NC(=O)CN)C(O)=O |&1:5|
Test 9
  N[C@H]1CCC[C@H]1C(=O)N(C(C1C=CC(=CC=1)[N+]([O-])=O)C(=O)NC1CCCCC1)[C@H]1CCC[C@H]1C(O)=O
  N[C@H]1CCC[C@H]1C(=O)N1[C@H]2CCC[C@H]2C1(O)C(=O)NC1CCCCC1
  N[C@H]1CCC[C@H]1C(O)(C(=O)NC1CCCCC1)N1[C@H]2CCC[C@H]2C1=O
  [O-][N+](=O)C1=CC=C(C=C1)C(C(=O)NC1CCCCC1)N1[C@H]2CCC[C@H]2C1=O

*** Test set ***
('rpe-multistep-reactions', '1')
('rpe-mode', 'one-tube')
('rpe-self-reaction', '1')
('rpe-max-depth', '1')
('rpe-max-products-count', '10')
Test 1
  CC=CC(=O)NC1CCCC1
  CC=CC(=O)NCC
  CC=CC(=O)N[C@@H](C)CC
  CCNC(=O)C=CC(O)=O
  C[C@@H](C(=O)NCC)C1C=CC=CC=1 |&1:1|
  C[C@@H](C(=O)N[C@@H](C)CC)C1C=CC=CC=1 |&1:1,a:5|
  C[C@@H](C1=CC=CC=C1)C(=O)NC1CCCC1 |&1:1|
  C[C@@H](CC)NC(=O)C=CC(O)=O
  OC(=O)C=CC(=O)NC1CCCC1
Test 1_aam
  C/C=C/C(=O)NC1CCCC1
  C/C=C/C(=O)NCC
  C/C=C/C(=O)N[C@@H](C)CC
  CCNC(=O)/C=C\C(O)=O
  C[C@@H](C(=O)NCC)C1C=CC=CC=1 |&1:1|
  C[C@@H](C(=O)N[C@@H](C)CC)C1C=CC=CC=1 |&1:1,a:5|
  C[C@@H](C1=CC=CC=C1)C(=O)NC1CCCC1 |&1:1|
  C[C@@H](CC)NC(=O)/C=C\C(O)=O
  OC(=O)/C=C\C(=O)NC1CCCC1
Test 2
  CC1C=CC[C@@H]2[C@H]1C(=O)C1C=CC=CC=1C2=O |&1:5,6|
  CC1C=CC[C@@H]2[C@H]1C(=O)C=CC2=O |&1:5,6|
  CC1C=CC[C@@H]2[C@H]1C(=O)OC2=O |&1:5,6|
  CC1C=CC[C@@H]2[C@H]1CCC2=O |&1:5,6|
  C[C@@H]1CC=CC[C@]1(C)C=O |&1:1,6|
  C[C@@]1(CC=CC[C@]1(C)F)C=O |&1:1,6|
  O=C1C=CC(=O)[C@@H]2CC=CC[C@H]12 |&1:6,11|
  O=C1CC[C@@H]2CC=CC[C@H]12 |&1:4,9|
  O=C1OC(=O)[C@@H]2CC=CC[C@H]12 |&1:5,10|
  O=C1[C@@H]2CC=CC[C@@H]2C(=O)C2C=CC=CC1=2 |&1:2,7|
Test 3
  CC(=O)O[C@@H]1[C@@H](O)[C@H](O)[C@@H](O)[C@H](O)[C@H]1O
  O[C@H]1[C@H](O)[C@@H](O)[C@H](OC(=O)C2CCCCC2)[C@@H](O)[C@@H]1O
Test 4
  NCC1OC1C(=O)NCC1OC1C(O)=O
  O=C1NCC2OC12
Test 5
  CC(=O)OC[C@H]1O[C@@H](O)[C@H](O)[C@@H](O)[C@@H]1O
  CC(=O)O[C@@H]1O[C@H](CO)[C@@H](O)[C@H](O)[C@H]1O
  CC(=O)O[C@@H]1[C@@H](CO)O[C@@H](O)[C@H](O)[C@H]1O
  CC(=O)O[C@@H]1[C@@H](O)[C@H](O)O[C@H](CO)[C@H]1O
  CC(=O)O[C@@H]1[C@@H](O)[C@H](O)[C@@H](CO)O[C@H]1O
Test 6
  C[C@@H](Cl)N(C)S
  C[C@@H](Cl)[N@@](C)S |&1:1,&2:3|
  C[C@@H](Cl)[N@@](C)S |&1:1,o1:3|
  C[C@H](Cl)N(C)S
Test 7
  C[N@@](S)/C=C/[C@H](O)Cl
  N/C=C/O
  N/C=C\O
Test 8
  NCC(=O)NCC(O)=O
  NCC(=O)NCCCC[C@@H](N)C(O)=O |&1:9|
  NCCCC[C@@H](N)C(=O)NCC(O)=O |&1:5|
  NCCCC[C@@H](N)C(=O)NCCCC[C@@H](N)C(O)=O |&1:5,14|
  NCCCC[C@@H](NC(=O)CN)C(O)=O |&1:5|
  N[C@@H](CCCCN)C(=O)N[C@H](CCCCN)C(O)=O |&1:1,10|
Test 9
  N[C@H]1CCC[C@H]1C(=O)N(C(C1C=CC(=CC=1)[N+]([O-])=O)C(=O)NC1CCCCC1)[C@H]1CCC[C@H]1C(O)=O
  N[C@H]1CCC[C@H]1C(=O)N1[C@H]2CCC[C@H]2C1(O)C(=O)NC1CCCCC1
  N[C@H]1CCC[C@H]1C(O)(C(=O)NC1CCCCC1)N([C@H]1CCC[C@H]1C(O)=O)C(=O)[C@@H]1CCC[C@@H]1N
  N[C@H]1CCC[C@H]1C(O)(C(=O)NC1CCCCC1)N1[C@H]2CCC[C@H]2C1=O
  [O-][N+](=O)C1=CC=C(C=C1)C(C(=O)NC1CCCCC1)N1[C@H]2CCC[C@H]2C1=O

*** Test set ***
('rpe-multistep-reactions', '1')
('rpe-mode', 'one-tube')
('rpe-self-reaction', '1')
('rpe-max-depth', '3')
('rpe-max-products-count', '4')
Test 1
  CC=CC(=O)NC1CCCC1
  CC=CC(=O)NCC
  CC=CC(=O)N[C@@H](C)CC
  CCNC(=O)C=CC(O)=O
Test 1_aam
  C/C=C/C(=O)NC1CCCC1
  C/C=C/C(=O)NCC
  C/C=C/C(=O)N[C@@H](C)CC
  CCNC(=O)/C=C\C(O)=O
Test 2
  O=C1C=CC(=O)[C@@H]2CC=CC[C@H]12 |&1:6,11|
  O=C1CC[C@@H]2CC=CC[C@H]12 |&1:4,9|
  O=C1OC(=O)[C@@H]2CC=CC[C@H]12 |&1:5,10|
  O=C1[C@@H]2CC=CC[C@@H]2C(=O)C2C=CC=CC1=2 |&1:2,7|
Test 3
  CC(=O)O[C@@H]1[C@@H](O)[C@H](O)[C@@H](O)[C@H](O)[C@H]1O
  CC(=O)O[C@@H]1[C@@H](O)[C@H](O)[C@@H](O)[C@H](OC(C)=O)[C@H]1O
  CC(=O)O[C@@H]1[C@@H](O)[C@H](O)[C@@H](OC(C)=O)[C@H](O)[C@H]1O
  CC(=O)O[C@H]1[C@H](OC(C)=O)[C@@H](O)[C@H](O)[C@@H](O)[C@@H]1O
Test 4
  NCC1OC1C(=O)NCC1OC1C(=O)NCC1OC1C(=O)NCC1OC1C(O)=O
  NCC1OC1C(=O)NCC1OC1C(=O)NCC1OC1C(O)=O
  NCC1OC1C(=O)NCC1OC1C(O)=O
  O=C1NCC2OC12
Test 5
  CC(=O)O[C@@H]1O[C@H](CO)[C@@H](O)[C@H](O)[C@H]1O
  CC(=O)O[C@@H]1[C@@H](CO)O[C@@H](O)[C@H](O)[C@H]1O
  CC(=O)O[C@@H]1[C@@H](O)[C@H](O)O[C@H](CO)[C@H]1O
  CC(=O)O[C@@H]1[C@@H](O)[C@H](O)[C@@H](CO)O[C@H]1O
Test 6
  C[C@@H](Cl)N(C)S
  C[C@@H](Cl)[N@@](C)S |&1:1,&2:3|
  C[C@@H](Cl)[N@@](C)S |&1:1,o1:3|
  C[C@H](Cl)N(C)S
Test 7
  C[N@@](S)/C=C/[C@H](O)Cl
  C[N@](S)/C=C/[C@H](O)Cl
  N/C=C/O
  N/C=C\O
Test 8
  NCC(=O)NCC(=O)NCC(O)=O
  NCC(=O)NCC(O)=O
  NCC(=O)NCCCC[C@@H](N)C(O)=O |&1:9|
  NCCCC[C@@H](NC(=O)CN)C(O)=O |&1:5|
Test 9
  N[C@H]1CCC[C@H]1C(=O)N(C(C1C=CC(=CC=1)[N+]([O-])=O)C(=O)NC1CCCCC1)[C@H]1CCC[C@H]1C(=O)N(C(C1C=CC(=CC=1)[N+]([O-])=O)C(=O)NC1CCCCC1)[C@H]1CCC[C@H]1C(=O)N(C(C1C=CC(=CC=1)[N+]([O-])=O)C(=O)NC1CCCCC1)[C@H]1CCC[C@H]1C(O)=O
  N[C@H]1CCC[C@H]1C(=O)N(C(C1C=CC(=CC=1)[N+]([O-])=O)C(=O)NC1CCCCC1)[C@H]1CCC[C@H]1C(=O)N(C(C1C=CC(=CC=1)[N+]([O-])=O)C(=O)NC1CCCCC1)[C@H]1CCC[C@H]1C(O)=O
  N[C@H]1CCC[C@H]1C(=O)N(C(C1C=CC(=CC=1)[N+]([O-])=O)C(=O)NC1CCCCC1)[C@H]1CCC[C@H]1C(O)=O
  [O-][N+](=O)C1=CC=C(C=C1)C(C(=O)NC1CCCCC1)N1[C@H]2CCC[C@H]2C1=O

*** Test set ***
('rpe-multistep-reactions', '1')
('rpe-mode', 'one-tube')
('rpe-self-reaction', '1')
('rpe-max-depth', '3')
('rpe-max-products-count', '10')
Test 1
  CC=CC(=O)NC1CCCC1
  CC=CC(=O)NCC
  CC=CC(=O)N[C@@H](C)CC
  CCNC(=O)C=CC(=O)NCC
  CCNC(=O)C=CC(O)=O
  C[C@@H](C(=O)NCC)C1C=CC=CC=1 |&1:1|
  C[C@@H](C(=O)N[C@@H](C)CC)C1C=CC=CC=1 |&1:1,a:5|
  C[C@@H](C1=CC=CC=C1)C(=O)NC1CCCC1 |&1:1|
  C[C@@H](CC)NC(=O)C=CC(O)=O
  OC(=O)C=CC(=O)NC1CCCC1
Test 1_aam
  C/C=C/C(=O)NC1CCCC1
  C/C=C/C(=O)NCC
  C/C=C/C(=O)N[C@@H](C)CC
  CCNC(=O)/C=C\C(=O)NCC
  CCNC(=O)/C=C\C(O)=O
  C[C@@H](C(=O)NCC)C1C=CC=CC=1 |&1:1|
  C[C@@H](C(=O)N[C@@H](C)CC)C1C=CC=CC=1 |&1:1,a:5|
  C[C@@H](C1=CC=CC=C1)C(=O)NC1CCCC1 |&1:1|
  C[C@@H](CC)NC(=O)/C=C\C(O)=O
  OC(=O)/C=C\C(=O)NC1CCCC1
Test 2
  CC1C=CC[C@@H]2[C@H]1C(=O)C=CC2=O |&1:5,6|
  CC1C=CC[C@@H]2[C@H]1C(=O)OC2=O |&1:5,6|
  C[C@@H]1CC=CC[C@]1(C)C=O |&1:1,6|
  C[C@@]1(CC=CC[C@]1(C)F)C=O |&1:1,6|
  O=C1C=CC(=O)[C@@H]2CC=CC[C@H]12 |&1:6,11|
  O=C1CC[C@@H]2CC=CC[C@H]12 |&1:4,9|
  O=C1OC(=O)[C@@H]2CC=CC[C@H]12 |&1:5,10|
  O=C1[C@@H]2CC=CC[C@@H]2C(=O)C2C=CC=CC1=2 |&1:2,7|
  O=C1[C@@H]2CC=CC[C@@H]2C(=O)[C@@H]2CC=CC[C@H]12 |&1:2,7,10,15|
  O=C1[C@@H]2CC=CC[C@@H]2C(=O)[C@H]2CC=CC[C@@H]12 |&1:2,7,10,15|
Test 3
  CC(=O)O[C@@H]1[C@@H](O)[C@H](O)[C@@H](O)[C@H](O)[C@H]1O
  CC(=O)O[C@@H]1[C@@H](O)[C@H](O)[C@@H](O)[C@H](OC(C)=O)[C@H]1O
  CC(=O)O[C@@H]1[C@@H](O)[C@H](O)[C@@H](OC(C)=O)[C@H](O)[C@H]1O
  CC(=O)O[C@@H]1[C@@H](O)[C@H](O)[C@@H](OC(C)=O)[C@H](OC(C)=O)[C@H]1O
  CC(=O)O[C@@H]1[C@@H](O)[C@H](OC(C)=O)[C@@H](O)[C@H](OC(C)=O)[C@H]1O
  CC(=O)O[C@@H]1[C@@H](OC(C)=O)[C@H](O)[C@@H](O)[C@H](O)[C@H]1O
  CC(=O)O[C@@H]1[C@@H](OC(C)=O)[C@H](O)[C@@H](O)[C@H](O)[C@H]1OC(C)=O
  CC(=O)O[C@H]1[C@H](O)[C@@H](O)[C@H](OC(C)=O)[C@@H](OC(C)=O)[C@@H]1O
  CC(=O)O[C@H]1[C@H](OC(C)=O)[C@@H](O)[C@H](O)[C@@H](O)[C@@H]1O
  O[C@H]1[C@H](O)[C@@H](O)[C@H](OC(=O)C2CCCCC2)[C@@H](O)[C@@H]1O
Test 4
  NCC1OC1C(=O)NCC1OC1C(=O)NCC1OC1C(=O)NCC1OC1C(O)=O
  NCC1OC1C(=O)NCC1OC1C(=O)NCC1OC1C(O)=O
  NCC1OC1C(=O)NCC1OC1C(O)=O
  O=C1NCC2OC12
  O=C1NCC2OC2C(=O)NCC2OC12
  O=C1NCC2OC2C(=O)NCC2OC2C(=O)NCC2OC12
Test 5
  CC(=O)OC[C@H]1O[C@@H](O)[C@H](O)[C@@H](O)[C@@H]1O
  CC(=O)O[C@@H]1O[C@H](CO)[C@@H](O)[C@H](O)[C@H]1O
  CC(=O)O[C@@H]1O[C@H](CO)[C@@H](O)[C@H](OC(C)=O)[C@H]1O
  CC(=O)O[C@@H]1O[C@H](CO)[C@@H](OC(C)=O)[C@H](O)[C@H]1O
  CC(=O)O[C@@H]1[C@@H](CO)O[C@@H](O)[C@H](O)[C@H]1O
  CC(=O)O[C@@H]1[C@@H](O)[C@H](O)O[C@H](CO)[C@H]1O
  CC(=O)O[C@@H]1[C@@H](O)[C@H](O)O[C@H](COC(C)=O)[C@H]1O
  CC(=O)O[C@@H]1[C@@H](O)[C@H](O)[C@@H](CO)O[C@H]1O
  CC(=O)O[C@@H]1[C@@H](OC(C)=O)[C@H](O)O[C@H](CO)[C@H]1O
  CC(=O)O[C@H]1[C@H](OC(C)=O)[C@@H](CO)O[C@@H](O)[C@@H]1O
Test 6
  C[C@@H](Cl)N(C)S
  C[C@@H](Cl)[N@@](C)S |&1:1,&2:3|
  C[C@@H](Cl)[N@@](C)S |&1:1,o1:3|
  C[C@H](Cl)N(C)S
Test 7
  C[N@@](S)/C=C/[C@H](O)Cl
  C[N@](S)/C=C/[C@H](O)Cl
  N/C=C/O
  N/C=C\O
Test 8
  NCC(=O)NCC(=O)NCC(=O)NCC(O)=O
  NCC(=O)NCC(=O)NCC(=O)NCCCC[C@@H](N)C(O)=O |&1:17|
  NCC(=O)NCC(=O)NCC(O)=O
  NCC(=O)NCC(=O)NCCCC[C@@H](N)C(O)=O |&1:13|
  NCC(=O)NCC(=O)NCCCC[C@@H](NC(=O)CN)C(O)=O |&1:13|
  NCC(=O)NCC(=O)N[C@@H](CCCCN)C(O)=O |&1:9|
  NCC(=O)NCC(O)=O
  NCC(=O)NCCCC[C@@H](N)C(O)=O |&1:9|
  NCC(=O)NCCCC[C@@H](NC(=O)CN)C(O)=O |&1:9|
  NCCCC[C@@H](NC(=O)CN)C(O)=O |&1:5|
Test 9
  N[C@H]1CCC[C@H]1C(=O)N(C(C1C=CC(=CC=1)[N+]([O-])=O)C(=O)NC1CCCCC1)[C@H]1CCC[C@H]1C(=O)N(C(C1C=CC(=CC=1)[N+]([O-])=O)C(=O)NC1CCCCC1)[C@H]1CCC[C@H]1C(=O)N(C(C1C=CC(=CC=1)[N+]([O-])=O)C(=O)NC1CCCCC1)[C@H]1CCC[C@H]1C(O)=O
  N[C@H]1CCC[C@H]1C(=O)N(C(C1C=CC(=CC=1)[N+]([O-])=O)C(=O)NC1CCCCC1)[C@H]1CCC[C@H]1C(=O)N(C(C1C=CC(=CC=1)[N+]([O-])=O)C(=O)NC1CCCCC1)[C@H]1CCC[C@H]1C(=O)N1[C@H]2CCC[C@H]2C1(O)C(=O)NC1CCCCC1
  N[C@H]1CCC[C@H]1C(=O)N(C(C1C=CC(=CC=1)[N+]([O-])=O)C(=O)NC1CCCCC1)[C@H]1CCC[C@H]1C(=O)N(C(C1C=CC(=CC=1)[N+]([O-])=O)C(=O)NC1CCCCC1)[C@H]1CCC[C@H]1C(O)=O
  N[C@H]1CCC[C@H]1C(=O)N(C(C1C=CC(=CC=1)[N+]([O-])=O)C(=O)NC1CCCCC1)[C@H]1CCC[C@H]1C(=O)N1[C@H]2CCC[C@H]2C1(O)C(=O)NC1CCCCC1
  N[C@H]1CCC[C@H]1C(=O)N(C(C1C=CC(=CC=1)[N+]([O-])=O)C(=O)NC1CCCCC1)[C@H]1CCC[C@H]1C(O)=O
  N[C@H]1CCC[C@H]1C(=O)N1[C@H]2CCC[C@H]2C1(O)C(=O)NC1CCCCC1
  N[C@H]1CCC[C@H]1C(O)(C(=O)NC1CCCCC1)N1[C@H]2CCC[C@H]2C1=O
  [O-][N+](=O)C1=CC=C(C=C1)C(C(=O)NC1CCCCC1)N1[C@H]2CCC[C@H]2C1=O
  [O-][N+](=O)C1C=CC(=CC=1)C(C(=O)NC1CCCCC1)N1[C@H]2CCC[C@H]2C(=O)N(C(C2C=CC(=CC=2)[N+]([O-])=O)C(=O)NC2CCCCC2)[C@H]2CCC[C@H]2C(=O)N(C(C2C=CC(=CC=2)[N+]([O-])=O)C(=O)NC2CCCCC2)[C@H]2CCC[C@H]2C1=O
  [O-][N+](=O)C1C=CC(=CC=1)C(C(=O)NC1CCCCC1)N1[C@H]2CCC[C@H]2C(=O)N(C(C2C=CC(=CC=2)[N+]([O-])=O)C(=O)NC2CCCCC2)[C@H]2CCC[C@H]2C1=O
